<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Geometric Data Analysis with GDAtools • GDAtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Geometric Data Analysis with GDAtools">
<meta property="og:description" content="GDAtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GDAtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/GDA_tutorial.html">Geometric Data Analysis with GDAtools</a>
    </li>
    <li>
      <a href="../articles/Tutoriel_AGD.html">L'analyse géométrique des données avec GDAtools</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nicolas-robette/GDAtools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Geometric Data Analysis with GDAtools</h1>
                        <h4 data-toc-skip class="author">Nicolas
Robette</h4>
            
            <h4 data-toc-skip class="date">2023-04-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nicolas-robette/GDAtools/blob/HEAD/vignettes/articles/GDA_tutorial.Rmd" class="external-link"><code>vignettes/articles/GDA_tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>GDA_tutorial.Rmd</code></div>

    </div>

    
    
<p><br>
This tutorial presents the use of the <code>GDAtools</code> package for
geometric data analysis. For further information on the statistical
procedures themselves, it is recommended to refer to the books
referenced on the home page of the website.</p>
<hr>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>For this example of Multiple Correspondence Analysis (MCA), we will
use one of the data sets provided with the package. This is information
about the tastes and cultural practices of 2000 individuals: listening
to musical genres (French popular music, rap, rock, jazz and classical)
and taste for film genres (comedy, crime film, animation, science
fiction, love film, musical). These 11 variables will be used as
“active” variables in the MCA and are completed by 3 “supplementary”
variables: gender, age and education level.<br></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>  <span class="co"># for plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nicolas-robette/GDAtools" class="external-link">GDAtools</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   2000 obs. of  14 variables:
 $ FrenchPop: Factor w/ 3 levels "No","Yes","NA": 2 1 2 1 2 1 1 1 1 2 ...
 $ Rap      : Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 1 1 1 1 1 1 ...
 $ Rock     : Factor w/ 3 levels "No","Yes","NA": 1 1 2 1 1 2 1 1 2 1 ...
 $ Jazz     : Factor w/ 3 levels "No","Yes","NA": 1 2 1 1 1 1 1 1 1 1 ...
 $ Classical: Factor w/ 3 levels "No","Yes","NA": 1 2 1 2 1 1 1 1 1 1 ...
 $ Comedy   : Factor w/ 3 levels "No","Yes","NA": 1 2 1 1 1 1 2 2 2 2 ...
 $ Crime    : Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 2 1 1 1 1 1 ...
 $ Animation: Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 1 1 1 1 1 1 ...
 $ SciFi    : Factor w/ 3 levels "No","Yes","NA": 2 1 1 1 1 2 1 1 1 1 ...
 $ Love     : Factor w/ 3 levels "No","Yes","NA": 1 1 2 1 1 1 1 1 1 1 ...
 $ Musical  : Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 1 1 1 1 1 1 ...
 $ Gender   : Factor w/ 2 levels "Men","Women": 1 1 2 1 2 2 2 2 1 1 ...
 $ Age      : Factor w/ 3 levels "15-24","25-49",..: 2 3 2 3 2 2 2 2 1 3 ...
 $ Educ     : Factor w/ 4 levels "None","Low","Medium",..: 3 4 3 4 2 1 3 2 2 2 ...</code></pre>
<p><br>
The active variables all have a “non response” (“NA”) category, which
concerns some individuals.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code> FrenchPop   Rap        Rock       Jazz      Classical  Comedy     Crime     
 No : 741   No :1730   No :1455   No :1621   No :1443   No :1141   No :1430  
 Yes:1249   Yes: 261   Yes: 535   Yes: 364   Yes: 552   Yes: 856   Yes: 555  
 NA :  10   NA :   9   NA :  10   NA :  15   NA :   5   NA :   3   NA :  15  
 Animation  SciFi       Love      Musical   
 No :1905   No :1845   No :1768   No :1923  
 Yes:  91   Yes: 143   Yes: 225   Yes:  66  
 NA :   4   NA :  12   NA :   7   NA :  11  </code></pre>
<p><br><strong>Specific MCA</strong> makes it possible to cancel these
categories out in the construction of the factorial space, while keeping
all the individuals. We start by locating the rank of the categories we
want to cancel out.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getindexcat.html">getindexcat</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] "FrenchPop.No"  "FrenchPop.Yes" "FrenchPop.NA"  "Rap.No"       
 [5] "Rap.Yes"       "Rap.NA"        "Rock.No"       "Rock.Yes"     
 [9] "Rock.NA"       "Jazz.No"       "Jazz.Yes"      "Jazz.NA"      
[13] "Classical.No"  "Classical.Yes" "Classical.NA"  "Comedy.No"    
[17] "Comedy.Yes"    "Comedy.NA"     "Crime.No"      "Crime.Yes"    
[21] "Crime.NA"      "Animation.No"  "Animation.Yes" "Animation.NA" 
[25] "SciFi.No"      "SciFi.Yes"     "SciFi.NA"      "Love.No"      
[29] "Love.Yes"      "Love.NA"       "Musical.No"    "Musical.Yes"  
[33] "Musical.NA"   </code></pre>
<p><br>
The vector of these ranks is then given as an argument in the specific
MCA function <a href="https://nicolas-robette.github.io/GDAtools/reference/speMCA.html"><code>speMCA()</code></a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/speMCA.html">speMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, excl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">18</span>,<span class="fl">21</span>,<span class="fl">24</span>,<span class="fl">27</span>,<span class="fl">30</span>,<span class="fl">33</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, we can use the list of <em>labels</em> of the “junk”
categories.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">junk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FrenchPop.NA"</span>, <span class="st">"Rap.NA"</span>, <span class="st">"Rock.NA"</span>, <span class="st">"Jazz.NA"</span>, <span class="st">"Classical.NA"</span>,</span>
<span>          <span class="st">"Comedy.NA"</span>, <span class="st">"Crime.NA"</span>, <span class="st">"Animation.NA"</span>, <span class="st">"SciFi.NA"</span>, <span class="st">"Love.NA"</span>, </span>
<span>          <span class="st">"Musical.NA"</span><span class="op">)</span></span>
<span><span class="va">mca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/speMCA.html">speMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, excl <span class="op">=</span> <span class="va">junk</span><span class="op">)</span></span></code></pre></div>
<p>The labels of these categories can be identified using the function
<a href="https://nicolas-robette.github.io/GDAtools/reference/ijunk.html"><code>ijunk()</code></a>,
which launches an interactive application for this purpose and allows to
copy and paste the appropriate code.</p>
<hr>
</div>
<div class="section level2">
<h2 id="clouds">Clouds<a class="anchor" aria-label="anchor" href="#clouds"></a>
</h2>
<p>The Benzécri corrected inertia rates give an idea of how much
information is represented by each axis.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/modif.rate.html">modif.rate</a></span><span class="op">(</span><span class="va">mca</span><span class="op">)</span><span class="op">$</span><span class="va">modif</span></span></code></pre></div>
<pre><code>        mrate cum.mrate
1 67.30532896  67.30533
2 22.64536000  89.95069
3  7.17043134  97.12112
4  2.26387669  99.38500
5  0.59232858  99.97733
6  0.02267443 100.00000</code></pre>
<p>We can see here that the first two axes capture most of the
information (nearly 90%). In the following, we will therefore
concentrate on the plane formed by axes 1 and 2.<br><br></p>
<div class="section level4">
<h4 id="cloud-of-individuals">Cloud of individuals<a class="anchor" aria-label="anchor" href="#cloud-of-individuals"></a>
</h4>
<p>The cloud of individuals does not have a particular shape (triangle,
horseshoe…), the points seem to be distributed in the whole plane
(1,2).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/cloud_ind-1.png" width="700"></p>
<p>However, in some cases, points may overlap and the structure of the
cloud of individuals is only imperfectly rendered by a scatter plot. It
is then possible to complete the first graph by a representation of the
density of points in the plane. The function <a href="https://nicolas-robette.github.io/GDAtools/reference/ggcloud_indiv.html"><code>ggcloud_indiv()</code></a>
allows this to be done using contours (like the contour lines of a
topographic map) or hexagonal surfaces (colored with a color gradient
according to the number of points located in the hexagon).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span>, col <span class="op">=</span> <span class="st">"lightgray"</span>, density <span class="op">=</span> <span class="st">"contour"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/cloud_ind_contour-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span>, density <span class="op">=</span> <span class="st">"hex"</span>, hex.bin <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/cloud_ind_hex-1.png" width="700"></p>
<p>Regardless of the density representation used, we observe that the
points seem to be more concentrated in an area immediately to the right
of the vertical axis.<br></p>
<p>NB: <a href="https://nicolas-robette.github.io/GDAtools/reference/ggcloud_indiv.html"><code>ggcloud_indiv()</code></a>
also allows the <em>name</em> of the observations to be displayed, when
this is of interest from an interpretation point of view.<br><br></p>
</div>
<div class="section level4">
<h4 id="cloud-of-variables">Cloud of variables<a class="anchor" aria-label="anchor" href="#cloud-of-variables"></a>
</h4>
<p>On the cloud of variables:</p>
<ul>
<li><p>listening to jazz and classical music and liking musicals seem to
be opposed to listening to rap and liking comedies on axis 1;</p></li>
<li><p>the taste for animation and science fiction to the taste for love
movies and musicals on axis 2.</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mca</span>, shapes <span class="op">=</span> <span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/cloud_var-1.png" width="700"></p>
<p>Many options are possible, including:</p>
<ul>
<li><p>adding symbols (circles, triangles, etc.) in addition to the
labels of the categories ;</p></li>
<li><p>selection or highlighting of the most important categories
according to different criteria (contribution, quality of
representation, typicality, etc.);</p></li>
<li><p>using size, italics, bold and underlining to identify the most
important categories.</p></li>
</ul>
<p> </p>
<p>The results are traditionally represented in a plane, i.e. in two
dimensions (here dimensions 1 and 2). But it is sometimes easier to
concentrate the interpretation on one axis at a time, which is possible
with the function <a href="https://nicolas-robette.github.io/GDAtools/reference/ggaxis_variables.html"><code>ggaxis_variables()</code></a>
(parameterized here to display the labels of the categories with a size
proportional to their contribution to the construction of the axis).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggaxis_variables.html">ggaxis_variables</a></span><span class="op">(</span><span class="va">mca</span>, axis <span class="op">=</span> <span class="fl">1</span>, prop <span class="op">=</span> <span class="st">"ctr"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/axis1-1.png" width="700"></p>
<p>However, to be robust, the interpretation of the factorial plane
cannot stop at a visual examination of the cloud of variables. This must
be completed by a careful analysis of statistical indicators, in
particular the <strong>contributions</strong> of the categories to the
construction of the axes and their <strong>quality of
representation</strong>.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="aids-to-interpretation">Aids to interpretation<a class="anchor" aria-label="anchor" href="#aids-to-interpretation"></a>
</h2>
<p>Most of the aids to interpretation and other useful information are
present in the object created by <a href="https://nicolas-robette.github.io/GDAtools/reference/speMCA.html"><code>speMCA()</code></a>
function. The package provides several functions to extract and organize
this information.</p>
<ul>
<li><p><a href="https://nicolas-robette.github.io/GDAtools/reference/contrib.html"><code>contrib()</code></a>
presents the contributions of the variables and the categories of these
variables to the construction of each axis and to the construction of
the cloud.</p></li>
<li><p><a href="https://nicolas-robette.github.io/GDAtools/reference/dimcontrib.html"><code>dimcontrib()</code></a>
extracts the contributions of the individuals and the categories of
variables to the construction of a particular axis.</p></li>
<li><p><a href="https://nicolas-robette.github.io/GDAtools/reference/dimdescr.html"><code>dimdescr()</code></a>
identifies the variables and variable categories most statistically
associated with the different axes. The measures of association used are
the <strong>correlation ratios</strong> (<strong>eta²</strong>) for the
variables and the <strong>correlation coefficients</strong> for the
categories.</p></li>
<li><p>The function <a href="https://nicolas-robette.github.io/GDAtools/reference/planecontrib.html"><code>planecontrib()</code></a>
extracts the contributions of individuals and of the categories of
variables to the construction of a particular <em>plane</em>.</p></li>
</ul>
<p>The function <a href="https://nicolas-robette.github.io/GDAtools/reference/tabcontrib.html"><code>tabcontrib()</code></a>
allows, for a given axis, to summarize the main contributions (by
default, only the contributions above the average are presented).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">mca</span>, dim <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="4%">
<col width="3%">
<col width="14%">
<col width="10%">
<col width="11%">
<col width="10%">
<col width="12%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Category</th>
<th align="right">Weight</th>
<th align="right">Quality of representation</th>
<th align="left">Contribution (left)</th>
<th align="left">Contribution (right)</th>
<th align="left">Total contribution</th>
<th align="left">Cumulated contribution</th>
<th align="left">Contribution of deviation</th>
<th align="left">Proportion to variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Classical</td>
<td align="left">Yes</td>
<td align="right">552</td>
<td align="right">0.478</td>
<td align="left">23.08</td>
<td align="left"></td>
<td align="left">31.88</td>
<td align="left">31.88</td>
<td align="left">31.88</td>
<td align="left">100</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">1443</td>
<td align="right">0.474</td>
<td align="left"></td>
<td align="left">8.8</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Jazz</td>
<td align="left">Yes</td>
<td align="right">364</td>
<td align="right">0.467</td>
<td align="left">25.49</td>
<td align="left"></td>
<td align="left">31.15</td>
<td align="left">63.04</td>
<td align="left">31.15</td>
<td align="left">100</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">1621</td>
<td align="right">0.448</td>
<td align="left"></td>
<td align="left">5.66</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Comedy</td>
<td align="left">Yes</td>
<td align="right">856</td>
<td align="right">0.253</td>
<td align="left"></td>
<td align="left">9.66</td>
<td align="left">16.88</td>
<td align="left">79.92</td>
<td align="left">16.88</td>
<td align="left">100</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">1141</td>
<td align="right">0.252</td>
<td align="left">7.22</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>The classical music and jazz listening variables alone contribute
more than 60% to the construction of axis 1. Listening to classical
music and jazz is thus opposed to not listening to them, and secondarily
to the taste for comedies.<br></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">mca</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="4%">
<col width="3%">
<col width="14%">
<col width="10%">
<col width="11%">
<col width="10%">
<col width="12%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Category</th>
<th align="right">Weight</th>
<th align="right">Quality of representation</th>
<th align="left">Contribution (left)</th>
<th align="left">Contribution (right)</th>
<th align="left">Total contribution</th>
<th align="left">Cumulated contribution</th>
<th align="left">Contribution of deviation</th>
<th align="left">Proportion to variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Rock</td>
<td align="left">Yes</td>
<td align="right">535</td>
<td align="right">0.229</td>
<td align="left"></td>
<td align="left">12.99</td>
<td align="left">17.77</td>
<td align="left">17.77</td>
<td align="left">17.77</td>
<td align="left">100</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">1455</td>
<td align="right">0.226</td>
<td align="left">4.78</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Love</td>
<td align="left">Yes</td>
<td align="right">225</td>
<td align="right">0.250</td>
<td align="left">17.24</td>
<td align="left"></td>
<td align="left">17.24</td>
<td align="left">35</td>
<td align="left">17.24</td>
<td align="left">88.79</td>
</tr>
<tr class="even">
<td align="left">FrenchPop</td>
<td align="left">No</td>
<td align="right">741</td>
<td align="right">0.199</td>
<td align="left"></td>
<td align="left">9.69</td>
<td align="left">15.39</td>
<td align="left">50.39</td>
<td align="left">15.39</td>
<td align="left">100</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Yes</td>
<td align="right">1249</td>
<td align="right">0.196</td>
<td align="left">5.69</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Musical</td>
<td align="left">Yes</td>
<td align="right">66</td>
<td align="right">0.191</td>
<td align="left">14.33</td>
<td align="left"></td>
<td align="left">14.33</td>
<td align="left">64.72</td>
<td align="left">14.33</td>
<td align="left">96.61</td>
</tr>
<tr class="odd">
<td align="left">SciFi</td>
<td align="left">Yes</td>
<td align="right">143</td>
<td align="right">0.160</td>
<td align="left"></td>
<td align="left">11.49</td>
<td align="left">11.49</td>
<td align="left">76.21</td>
<td align="left">11.49</td>
<td align="left">92.72</td>
</tr>
<tr class="even">
<td align="left">Rap</td>
<td align="left">Yes</td>
<td align="right">261</td>
<td align="right">0.164</td>
<td align="left"></td>
<td align="left">11.05</td>
<td align="left">11.05</td>
<td align="left">87.27</td>
<td align="left">11.05</td>
<td align="left">86.56</td>
</tr>
</tbody>
</table>
<p>On axis 2, listening to rock and rap music and the taste for science
fiction films are opposed to the taste for love films and musicals and
the listening of French variety music.</p>
<p>One way to summarize the relationships between the active variables
and the factorial axes is the so-called “square of relationships”
(<em>carré des liaisons</em>) proposed by Escofier and Pagès (2008). It
uses correlation ratios to represent these relationships.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggeta2_variables.html">ggeta2_variables</a></span><span class="op">(</span><span class="va">mca</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Square of relationships"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/eta2_plot-1.png" width="700"></p>
<p>We see that listening to jazz and classical music is highly
correlated with axis 1 and not at all with axis 2, and that the active
variables most correlated with axis 2 are only moderately so.</p>
<hr>
</div>
<div class="section level2">
<h2 id="structuring-factors">Structuring factors<a class="anchor" aria-label="anchor" href="#structuring-factors"></a>
</h2>
<div class="section level4">
<h4 id="supplementary-variables">Supplementary variables<a class="anchor" aria-label="anchor" href="#supplementary-variables"></a>
</h4>
<p>We can go further by studying the relationship between the factorial
space and the supplementary variables, in this case gender, age and
education. A first step is to project the supplementary variables onto
the cloud of variables.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vcloud</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mca</span>, shapes<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggadd_supvars.html">ggadd_supvars</a></span><span class="op">(</span><span class="va">vcloud</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/cloud_varsup-1.png" width="700"></p>
<p>It is possible to set the display of each of the supplementary
variables separately with the function <a href="https://nicolas-robette.github.io/GDAtools/reference/ggadd_supvar.html"><code>ggadd_supvar()</code></a>
(without “s”). However, there are several drawbacks: more lines of code
and the risk of overlapping of the labels of the categories.</p>
<p>The level of education seems to be associated above all with axis 1,
the most educated being on the side of jazz and classical music
listening. Gender seems to be linked only to axis 2, with women at the
bottom of the plane and men at the top. As for age, it is associated
with both axes: individuals move from the northeast quadrant to the
southwest quadrant as their age increases.</p>
<p>These initial observations can be statistically confirmed by
measuring the degree of association between the supplementary variables
and the axes using the <strong>correlation ratio</strong>
(<strong>eta²</strong>).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dimeta2.html">dimeta2</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>       dim.1 dim.2
Gender   0.0   6.0
Age      3.8  14.2
Educ     5.9   3.3</code></pre>
<p>Education is the supplementary variable most associated with axis 1:
it “explains” 5.9% of the variance of individual coordinates on this
axis. Age is also associated with the first axis, but to a lesser
extent, and gender not at all.</p>
<p>On axis 2, age is the most structuring variable, ahead of gender and
education level. We also see that age is clearly more related to axis 2
than to axis 1.</p>
<p>At the level of the categories, the association of an supplementary
variable category with an axis can be characterized from the
<strong>correlation coefficients</strong>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">des</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimdescr.html">dimdescr</a></span><span class="op">(</span><span class="va">mca</span>, vars <span class="op">=</span> <span class="va">Taste</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">des</span><span class="op">$</span><span class="va">dim.1</span><span class="op">$</span><span class="va">categories</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="17%">
<col width="20%">
<col width="18%">
<col width="17%">
<col width="16%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left">categories</th>
<th align="right">mean.y.in.xcat</th>
<th align="right">mean.y.global</th>
<th align="right">sd.y.in.xcat</th>
<th align="right">sd.y.global</th>
<th align="right">cor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age.15-24</td>
<td align="right">0.156</td>
<td align="right">0</td>
<td align="right">0.355</td>
<td align="right">0.369</td>
<td align="right">0.176</td>
</tr>
<tr class="even">
<td align="left">Educ.None</td>
<td align="right">0.094</td>
<td align="right">0</td>
<td align="right">0.324</td>
<td align="right">0.369</td>
<td align="right">0.145</td>
</tr>
<tr class="odd">
<td align="left">Educ.Low</td>
<td align="right">0.052</td>
<td align="right">0</td>
<td align="right">0.355</td>
<td align="right">0.369</td>
<td align="right">0.100</td>
</tr>
<tr class="even">
<td align="left">Age.25-49</td>
<td align="right">0.006</td>
<td align="right">0</td>
<td align="right">0.358</td>
<td align="right">0.369</td>
<td align="right">0.015</td>
</tr>
<tr class="odd">
<td align="left">Gender.Women</td>
<td align="right">0.004</td>
<td align="right">0</td>
<td align="right">0.370</td>
<td align="right">0.369</td>
<td align="right">0.012</td>
</tr>
<tr class="even">
<td align="left">Gender.Men</td>
<td align="right">-0.005</td>
<td align="right">0</td>
<td align="right">0.368</td>
<td align="right">0.369</td>
<td align="right">-0.012</td>
</tr>
<tr class="odd">
<td align="left">Educ.Medium</td>
<td align="right">-0.040</td>
<td align="right">0</td>
<td align="right">0.376</td>
<td align="right">0.369</td>
<td align="right">-0.051</td>
</tr>
<tr class="even">
<td align="left">Age.50+</td>
<td align="right">-0.061</td>
<td align="right">0</td>
<td align="right">0.369</td>
<td align="right">0.369</td>
<td align="right">-0.142</td>
</tr>
<tr class="odd">
<td align="left">Educ.High</td>
<td align="right">-0.141</td>
<td align="right">0</td>
<td align="right">0.382</td>
<td align="right">0.369</td>
<td align="right">-0.213</td>
</tr>
</tbody>
</table>
<p>On axis 1, those with no or little education and those aged 15-24 are
opposed to those with more education and those aged 50 and over. The
other categories appear to have little relationship with the axis (their
correlation coefficients, in the last column of the table, are close to
0).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">des</span><span class="op">$</span><span class="va">dim.2</span><span class="op">$</span><span class="va">categories</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="17%">
<col width="20%">
<col width="18%">
<col width="17%">
<col width="16%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left">categories</th>
<th align="right">mean.y.in.xcat</th>
<th align="right">mean.y.global</th>
<th align="right">sd.y.in.xcat</th>
<th align="right">sd.y.global</th>
<th align="right">cor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age.15-24</td>
<td align="right">0.236</td>
<td align="right">0</td>
<td align="right">0.320</td>
<td align="right">0.342</td>
<td align="right">0.288</td>
</tr>
<tr class="even">
<td align="left">Gender.Men</td>
<td align="right">0.088</td>
<td align="right">0</td>
<td align="right">0.302</td>
<td align="right">0.342</td>
<td align="right">0.245</td>
</tr>
<tr class="odd">
<td align="left">Age.25-49</td>
<td align="right">0.049</td>
<td align="right">0</td>
<td align="right">0.333</td>
<td align="right">0.342</td>
<td align="right">0.123</td>
</tr>
<tr class="even">
<td align="left">Educ.High</td>
<td align="right">0.076</td>
<td align="right">0</td>
<td align="right">0.327</td>
<td align="right">0.342</td>
<td align="right">0.123</td>
</tr>
<tr class="odd">
<td align="left">Educ.Low</td>
<td align="right">0.016</td>
<td align="right">0</td>
<td align="right">0.341</td>
<td align="right">0.342</td>
<td align="right">0.034</td>
</tr>
<tr class="even">
<td align="left">Educ.Medium</td>
<td align="right">0.007</td>
<td align="right">0</td>
<td align="right">0.335</td>
<td align="right">0.342</td>
<td align="right">0.009</td>
</tr>
<tr class="odd">
<td align="left">Educ.None</td>
<td align="right">-0.100</td>
<td align="right">0</td>
<td align="right">0.341</td>
<td align="right">0.342</td>
<td align="right">-0.167</td>
</tr>
<tr class="even">
<td align="left">Gender.Women</td>
<td align="right">-0.081</td>
<td align="right">0</td>
<td align="right">0.357</td>
<td align="right">0.342</td>
<td align="right">-0.245</td>
</tr>
<tr class="odd">
<td align="left">Age.50+</td>
<td align="right">-0.131</td>
<td align="right">0</td>
<td align="right">0.299</td>
<td align="right">0.342</td>
<td align="right">-0.330</td>
</tr>
</tbody>
</table>
<p>On axis 2, men, those under 50, and those with higher education
contrast with women, those over 50, and those with no degree.</p>
</div>
<div class="section level4">
<h4 id="analysis-of-one-supplementary-variable">Analysis of one supplementary variable<a class="anchor" aria-label="anchor" href="#analysis-of-one-supplementary-variable"></a>
</h4>
<p>Let’s continue the analysis by focusing on <em>one</em> supplementary
variable, education level. The function <a href="https://nicolas-robette.github.io/GDAtools/reference/supvar.html"><code>supvar()</code></a>
provides:</p>
<ul>
<li><p>the coordinates of the categories on the axes,</p></li>
<li><p>their <em>squared cosines</em> (which gives the quality of
representation of a category on an axis),</p></li>
<li><p>their dispersion (variance) on the axes,</p></li>
<li><p>the correlation ratios (<em>eta²</em>) between the variable and
the axes,</p></li>
<li><p>the <em>typicality tests</em> (to which we will return in the
next section),</p></li>
<li><p>the <em>correlation coefficients</em> between the categories and
the axes.</p></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/supvar.html">supvar</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">)</span></span></code></pre></div>
<pre><code>$weight
  None    Low Medium   High 
   490    678    357    475 

$coord
           dim.1     dim.2     dim.3     dim.4     dim.5
None    0.254716 -0.293253 -0.191563  0.094510 -0.050520
Low     0.140147  0.046951  0.002259 -0.063613 -0.044181
Medium -0.109057  0.019669  0.054436  0.070183 -0.027962
High   -0.380835  0.220714  0.153475 -0.059443  0.136194

$cos2
          dim.1    dim.2    dim.3    dim.4    dim.5
None   0.021054 0.027906 0.011908 0.002899 0.000828
Low    0.010073 0.001131 0.000003 0.002075 0.001001
Medium 0.002584 0.000084 0.000644 0.001070 0.000170
High   0.045175 0.015173 0.007337 0.001101 0.005777

$var
           dim.1    dim.2    dim.3    dim.4    dim.5
None    0.104915 0.116125 0.115232 0.103800 0.086031
Low     0.125921 0.116092 0.109029 0.087945 0.087735
Medium  0.141298 0.112505 0.097031 0.102449 0.094541
High    0.145983 0.107170 0.091066 0.106049 0.113352
within  0.128284 0.113341 0.104141 0.098718 0.094616
between 0.008061 0.003923 0.001598 0.000524 0.000555
total   0.136345 0.117264 0.105739 0.099242 0.095172
eta2    0.059123 0.033455 0.015115 0.005279 0.005832

$typic
           dim.1     dim.2     dim.3     dim.4     dim.5
None    6.487410 -7.468929 -4.878958  2.407110 -1.286704
Low     4.487336  1.503312  0.072336 -2.036827 -1.414633
Medium -2.272883  0.409932  1.134503  1.462690 -0.582753
High   -9.502876  5.507427  3.829615 -1.483270  3.398406

$pval
          dim.1    dim.2    dim.3    dim.4    dim.5
None   0.000000 0.000000 0.000001 0.016079 0.198197
Low    0.000007 0.132758 0.942334 0.041667 0.157176
Medium 0.023033 0.681856 0.256584 0.143552 0.560059
High   0.000000 0.000000 0.000128 0.138003 0.000678

$cor
        dim.1  dim.2  dim.3  dim.4  dim.5
None    0.145 -0.167 -0.109  0.054 -0.029
Low     0.100  0.034  0.002 -0.046 -0.032
Medium -0.051  0.009  0.025  0.033 -0.013
High   -0.213  0.123  0.086 -0.033  0.076</code></pre>
<p>Graphically, we can represent the <em>subcloud</em> of each category
using a <strong>concentration ellipse</strong>, which is centered on the
mean point and encompasses 86% of individuals with that category.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">icloud</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggadd_kellipses.html">ggadd_kellipses</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/educ_ellipses-1.png" width="700"></p>
<p>Even if, as we have seen, the education level categories are ordered
along axis 1, the subclouds overlap to a large extent, because the
association between the variable and the axis is moderate.</p>
<p>Let us now look more specifically at the subcloud of the most highly
educated individuals (the 4th category of the variable
<code>Educ</code>).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggadd_kellipses.html">ggadd_kellipses</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, sel <span class="op">=</span> <span class="fl">4</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/educ_ellipse-1.png" width="700"></p>
<p>A concentration ellipse is useful because it jointly represents the
mean point of the category and the dispersion of the subcloud along the
axes. Here, we see that although the mean point of the most highly
educated individuals is located in the northwest quadrant, a
non-negligible portion of the points in the subcloud are to the right
and/or bottom of the plane.</p>
<p>The concentration ellipses, on the other hand, give only an imperfect
representation of the distribution of the points of the subcloud,
because of the possible superposition of the points (in a similar way to
what we have seen for the cloud of individuals) and its centering on the
mean point. It can therefore be interesting to complete a concentration
ellipse with a representation of the density of the points in the
subcloud, in the form of contours or surfaces.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggadd_density.html">ggadd_density</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, var <span class="op">=</span> <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, cat <span class="op">=</span> <span class="st">"High"</span>, density <span class="op">=</span> <span class="st">"contour"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/educ_contour-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggadd_density.html">ggadd_density</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, var <span class="op">=</span> <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, cat <span class="op">=</span> <span class="st">"High"</span>, density <span class="op">=</span> <span class="st">"area"</span>, ellipse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/educ_area-1.png" width="700"></p>
<p>Here we see that there appears to be a concentration of highly
educated individuals immediately to the right of the vertical axis, in
an area that also corresponds to a concentration of points in the cloud
of individuals (see above).</p>
<p>A further step in the analysis consists in neutralizing the influence
of the distribution of the points of the cloud of individuals on that of
the subcloud, by asking in which parts of the plane the most highly
educated are over/under represented. In the following graph, we
represent in each hexagonal tile the proportion of highly educated
individuals, centered in relation to the proportion of highly educated
individuals in the whole sample. In other words, we represent the
over/under-representation of highly educated individuals in each portion
of the plane. The graph is made more readable by a smoothing procedure
derived from spatial analysis in geography (<em>inverse distance
weighting</em>).</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggsmoothed_supvar.html">ggsmoothed_supvar</a></span><span class="op">(</span><span class="va">mca</span>, var <span class="op">=</span> <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, cat <span class="op">=</span> <span class="st">"High"</span>, center <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/educ_smoothed-1.png" width="700"></p>
<p>The most highly educated individuals are overrepresented throughout
the northwest quadrant, but also among the westernmost of the southwest
quadrant.</p>
</div>
<div class="section level4">
<h4 id="interaction-between-two-supplementary-variables">Interaction between two supplementary variables<a class="anchor" aria-label="anchor" href="#interaction-between-two-supplementary-variables"></a>
</h4>
<p>Interactions between several supplementary variables can also be
studied, for example here between gender and age.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggadd_interaction.html">ggadd_interaction</a></span><span class="op">(</span><span class="va">vcloud</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Gender</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Age</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/interaction-1.png" width="700"></p>
<p>Gender and age appear to interact little in the plane (1,2). Note,
however, that on axis 1, the differences between the youngest and oldest
individuals are larger for women than for men, and that on axis 2, the
youngest individuals differ more by gender than the oldest.</p>
<p>Note: The analyses performed here on supplementary variables are
similarly feasible for supplementary <em>individuals</em>, using the
functions <a href="https://nicolas-robette.github.io/GDAtools/reference/supind.html"><code>supind()</code></a>
and <a href="https://nicolas-robette.github.io/GDAtools/reference/ggadd_supind.html"><code>ggadd_supind()</code></a>.
This is useful when some individuals were excluded from the MCA because
they were too atypical or because some information was missing, for
example.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="inductive-analysis">Inductive analysis<a class="anchor" aria-label="anchor" href="#inductive-analysis"></a>
</h2>
<p>If one wishes to assess the generalizability of the results, one can
complement the descriptive analyses above with statistical inference
procedures that borrow from inductive data analysis and combinatorial
approaches (for this part even more than for the others, we refer to Le
Roux and Rouanet, 2004 &amp; 2010).</p>
<p>The typicality problem consists in asking whether a group of
individuals can be assimilated to the reference population or whether it
is atypical. A <strong>typicality test</strong> calculates a
<em>combinatorial p-value</em>, which defines the “degree of typicality”
of the mean point of the group of individuals. A low p-value is
considered statistically significant in the combinatorial sense and
reflects a difference that is probably not due to chance.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dimtypicality.html">dimtypicality</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>$dim.1
             weight test.stat p.value
Age.15-24       297  7.890052 0.00000
Educ.None       490  6.487410 0.00000
Educ.Low        678  4.487336 0.00001
Age.25-49       849  0.669142 0.50340
Gender.Women   1042  0.543265 0.58695
Gender.Men      958 -0.543265 0.58695
Educ.Medium     357 -2.272883 0.02303
Age.50+         854 -6.340738 0.00000
Educ.High       475 -9.502876 0.00000

$dim.2
             weight  test.stat p.value
Age.15-24       297  12.875430 0.00000
Gender.Men      958  10.972527 0.00000
Age.25-49       849   5.520379 0.00000
Educ.High       475   5.507427 0.00000
Educ.Low        678   1.503312 0.13276
Educ.Medium     357   0.409932 0.68186
Educ.None       490  -7.468929 0.00000
Gender.Women   1042 -10.972527 0.00000
Age.50+         854 -14.772247 0.00000</code></pre>
<p>At a 5 percent threshold, the mean points for women, men, and
middle-aged people are not significantly different from the mean point
for the entire population on axis 1 (i.e., 0). On axis 2, it is the mean
points of the low and middle education levels that do not differ
significantly from the origin.</p>
<p>One can study the results of typicality tests for a supplementary
variable in particular using the function <a href="https://nicolas-robette.github.io/GDAtools/reference/supvar.html"><code>supvar()</code></a>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vseduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/supvar.html">supvar</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">)</span></span>
<span><span class="va">vseduc</span><span class="op">$</span><span class="va">pval</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>          dim.1    dim.2
None   0.000000 0.000000
Low    0.000007 0.132758
Medium 0.023033 0.681856
High   0.000000 0.000000</code></pre>
<p>We see that, on axis 1, all the education level categories are
significantly different from 0 at a 5% threshold, they are atypical of
the cloud of all individuals, but this is not the case for the “Low” and
“Medium” categories on axis 2.</p>
<p> </p>
<p><strong>Confidence ellipses</strong> follow the same logic as
typicality tests. With a conventional significance level of 5%, the
confidence ellipse is a 95% confidence zone representing, for a
category, the set of possible mean points that are not significantly
different from the observed mean point.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># p &lt;- ggcloud_indiv(mca, col='lightgrey')</span></span>
<span><span class="fu"><a href="../reference/ggadd_ellipses.html">ggadd_ellipses</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, level <span class="op">=</span> <span class="fl">0.05</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/educ_conc_ellipses-1.png" width="700"></p>
<p>We find here graphically the results obtained with the typicality
tests.</p>
<p> </p>
<p>A <strong>homogeneity test</strong> is a combinatorial procedure that
aims at comparing several groups of individuals. The question is to know
if, on a given axis, the positions of two groups of individuals are
significantly different (i.e. if the p-values are all very close to 0).
The groups correspond to the different categories of a variable.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ht</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/homog.test.html">homog.test</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ht</span><span class="op">$</span><span class="va">dim.1</span><span class="op">$</span><span class="va">p.values</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>       None Low Medium High
None      1   0      0    0
Low       0   1      0    0
Medium    0   0      1    0
High      0   0      0    1</code></pre>
<p>On axis 1, the mean points of the education level categories are all
significantly different from each other.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ht</span><span class="op">$</span><span class="va">dim.2</span><span class="op">$</span><span class="va">p.values</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>       None   Low Medium High
None      1 0.000  0.000    0
Low       0 1.000  0.223    0
Medium    0 0.223  1.000    0
High      0 0.000  0.000    1</code></pre>
<p>This is not the case on axis 2, where the “Low” and “Medium”
categories are not significantly different (p-value = 0.22).</p>
<hr>
</div>
<div class="section level2">
<h2 id="internal-validation">Internal validation<a class="anchor" aria-label="anchor" href="#internal-validation"></a>
</h2>
<p>The lack of robustness of MCAs, or the absence of means to measure
this robustness, is sometimes presented as one of the weaknesses of
geometric data analysis. These criticisms are hardly relevant,
especially since there are techniques for the “internal validation” of
MCA results. Ludovic Lebart (2006; 2007) has proposed the use of
<em>bootstrap</em>, i.e. resampling by random draw with replacement.
This approach has the advantage of being non-parametric, i.e. it does
not rely on any of the probabilistic assumptions of frequentist
inference.</p>
<p>Lebart proposes several methods. The <strong>total bootstrap</strong>
uses new MCAs computed from bootstrap replications of the initial
data.</p>
<ul>
<li><p>In the <em>type 1</em> total bootstrap, the sign of the
coordinates is corrected if necessary (the direction of the axes of an
ACM being arbitrary).</p></li>
<li><p>In the <em>type 2</em>, the order of the axes and the sign of the
coordinates are corrected if necessary.</p></li>
<li><p>In <em>type 3</em>, a procustean rotation is used to find the
best overlap between the initial and replicated axes.</p></li>
</ul>
<p>The <strong>partial bootstrap</strong>, on the other hand, does not
compute a new MCA: it projects bootstrap replications of the initial
data as supplementary elements of the MCA. It gives a more optimistic
(or less demanding) view of the stability of the results than the total
bootstrap.</p>
<p>Below, the results of a partial bootstrap (with 30 replications, a
number generally considered sufficient by Lebart) are represented with
confidence ellipses. We can see that if the points of the bootstrap
replications of some categories are relatively scattered, this is only
the case for categories far from the origin of the plane and does not
change the interpretation of the MCA results: they are quite robust.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggbootvalid_variables.html">ggbootvalid_variables</a></span><span class="op">(</span><span class="va">mca</span>, type <span class="op">=</span> <span class="st">"partial"</span>, K <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/bootstrap-1.png" width="700"></p>
<p>It is possible to conduct the same type of analysis for supplementary
variables with the function <a href="https://nicolas-robette.github.io/GDAtools/reference/ggbootvalid_supvars.html"><code>ggbootvalid_supvars()</code></a>,
and to obtain the results of bootstrap replication calculations (without
graphing) with the functions <a href="https://nicolas-robette.github.io/GDAtools/reference/bootvalid_variables.html"><code>bootvalid_variables()</code></a>
and <a href="https://nicolas-robette.github.io/GDAtools/reference/bootvalid_supvars.html"><code>bootvalid_supvars()</code></a>.</p>
<hr>
</div>
<div class="section level2">
<h2 id="mca-and-clustering">MCA and clustering<a class="anchor" aria-label="anchor" href="#mca-and-clustering"></a>
</h2>
<p>MCA and automatic clustering techniques are often used together. For
example, after having represented the data by factorial planes, one may
wish to obtain a summary in the form of a typology, i.e. to group
together individuals who are similar. To do this, we can use the
original data or the coordinates of the individuals in the MCA
cloud.</p>
<p>We perform here a <strong>Ascending Hierarchical
Classification</strong> (AHC) from the coordinates of the individuals in
the factorial plane (1,2), then a partition in 3 clusters.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">mca</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ahc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"ward.D2"</span><span class="op">)</span></span>
<span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">ahc</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The partition thus created can then be used for further analysis, for
example by crossing it with supplementary variables, or more simply by
representing the subclouds of individuals corresponding to the clusters
of the typology, using <strong>convex hulls</strong>. A convex hull is
the smallest convex polygon among those containing a set of points. In
the context of MCA, convex hulls are an interesting graphical
representation, especially if the subclouds represented do not overlap
too much, as is the case here.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggadd_chulls.html">ggadd_chulls</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, <span class="va">cluster</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/chull-1.png" width="700"></p>
<p>Some remarks:</p>
<ul>
<li><p>The function <a href="https://nicolas-robette.github.io/GDAtools/reference/quadrant.html"><code>quadrant()</code></a>
also creates a typology of individuals, in a simpler way: each
individual is classified according to the part of the plane (the
“quadrant”) where it is located (northwest, northeast, southeast,
southwest).</p></li>
<li><p>There are many measures of distance / similarity. In the example
above, we used the Euclidean distance between the coordinates of the
individuals. If we perform an automatic clustering <em>from the original
variables</em> of the MCA, it is consistent to use the chi-2 distance,
the one used by correspondence analyses, which is possible with the
function <a href="https://nicolas-robette.github.io/GDAtools/reference/dist.chi2.html"><code>dist.chi2()</code></a>.</p></li>
<li><p>The function <a href="https://nicolas-robette.github.io/GDAtools/reference/ahc.plots.html"><code>ahc.plots()</code></a>
proposes some graphical representations which give indications for the
choice of the number of clusters from the results of an AHC.</p></li>
<li><p>If the AHC is the most widespread automatic clustering technique
in geometric data analysis, there are many others (see for example the
package <a href="https://cran.r-project.org/package=cluster" class="external-link"><code>cluster</code></a>).</p></li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="mca-variants">MCA variants<a class="anchor" aria-label="anchor" href="#mca-variants"></a>
</h2>
<div class="section level4">
<h4 id="class-specific-analysis">Class Specific Analysis<a class="anchor" aria-label="anchor" href="#class-specific-analysis"></a>
</h4>
<p>The <strong>Class Specific Analysis</strong> (CSA) is an extension of
MCA which allows to study a subcloud of individuals by taking into
account the distribution of variables in the subcloud <em>and</em> in
the whole cloud. It is thus a question of taking into account the fact
that the structure of the subcloud does not exist <em>in abstracto</em>
but in relation to the cloud in which it is included.</p>
<p>CSA is illustrated here using the subcloud of the most highly
educated individuals.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/csMCA.html">csMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">==</span><span class="st">"High"</span>, excl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">18</span>,<span class="fl">21</span>,<span class="fl">24</span>,<span class="fl">27</span>,<span class="fl">30</span>,<span class="fl">33</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">csa</span>, shapes <span class="op">=</span> <span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/csa_cloud_var-1.png" width="700"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">csa</span>, dim <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="4%">
<col width="3%">
<col width="14%">
<col width="10%">
<col width="11%">
<col width="10%">
<col width="12%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Category</th>
<th align="right">Weight</th>
<th align="right">Quality of representation</th>
<th align="left">Contribution (left)</th>
<th align="left">Contribution (right)</th>
<th align="left">Total contribution</th>
<th align="left">Cumulated contribution</th>
<th align="left">Contribution of deviation</th>
<th align="left">Proportion to variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Jazz</td>
<td align="left">Yes</td>
<td align="right">145</td>
<td align="right">0.629</td>
<td align="left">41.85</td>
<td align="left"></td>
<td align="left">51.08</td>
<td align="left">51.08</td>
<td align="left">17.25</td>
<td align="left">33.76</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">326</td>
<td align="right">0.608</td>
<td align="left"></td>
<td align="left">9.23</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Classical</td>
<td align="left">Yes</td>
<td align="right">183</td>
<td align="right">0.363</td>
<td align="left">17.79</td>
<td align="left"></td>
<td align="left">24.55</td>
<td align="left">75.63</td>
<td align="left">6.9</td>
<td align="left">28.1</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">290</td>
<td align="right">0.359</td>
<td align="left"></td>
<td align="left">6.76</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Animation</td>
<td align="left">Yes</td>
<td align="right">34</td>
<td align="right">0.149</td>
<td align="left"></td>
<td align="left">12.43</td>
<td align="left">12.43</td>
<td align="left">88.06</td>
<td align="left">4.64</td>
<td align="left">35.66</td>
</tr>
</tbody>
</table>
<p>We can see that, as in the MCA, listening to jazz and classical music
structure axis 1, but this time much more strongly since these two
variables alone contribute 75% to the construction of the axis.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">csa</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="4%">
<col width="3%">
<col width="14%">
<col width="10%">
<col width="11%">
<col width="10%">
<col width="12%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Category</th>
<th align="right">Weight</th>
<th align="right">Quality of representation</th>
<th align="left">Contribution (left)</th>
<th align="left">Contribution (right)</th>
<th align="left">Total contribution</th>
<th align="left">Cumulated contribution</th>
<th align="left">Contribution of deviation</th>
<th align="left">Proportion to variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Animation</td>
<td align="left">Yes</td>
<td align="right">34</td>
<td align="right">0.651</td>
<td align="left">59.05</td>
<td align="left"></td>
<td align="left">59.05</td>
<td align="left">59.05</td>
<td align="left">22.06</td>
<td align="left">35.66</td>
</tr>
<tr class="even">
<td align="left">SciFi</td>
<td align="left">Yes</td>
<td align="right">38</td>
<td align="right">0.149</td>
<td align="left">9.51</td>
<td align="left"></td>
<td align="left">9.51</td>
<td align="left">68.55</td>
<td align="left">2.53</td>
<td align="left">24.72</td>
</tr>
<tr class="odd">
<td align="left">Rock</td>
<td align="left">Yes</td>
<td align="right">203</td>
<td align="right">0.118</td>
<td align="left">6.71</td>
<td align="left"></td>
<td align="left">6.71</td>
<td align="left">75.26</td>
<td align="left">2.55</td>
<td align="left">27.32</td>
</tr>
<tr class="even">
<td align="left">Jazz</td>
<td align="left">Yes</td>
<td align="right">145</td>
<td align="right">0.075</td>
<td align="left">5.43</td>
<td align="left"></td>
<td align="left">5.43</td>
<td align="left">80.69</td>
<td align="left">2.16</td>
<td align="left">32.22</td>
</tr>
</tbody>
</table>
<p>It is above all the taste for animation movies that contributes to
the construction of axis 2.</p>
<p>In sum, the subcloud of the variables for the most highly educated
individuals has points in common with that of the population as a whole,
but also some very marked specificities.</p>
<p>The similarity between the MCA on all individuals and the CSA on the
most highly educated individuals can be measured by studying the angles
between the axes of the two analyses, with the function <a href="https://nicolas-robette.github.io/GDAtools/reference/angles.csa.html"><code>angles.csa()</code></a>.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/angles.csa.html">angles.csa</a></span><span class="op">(</span><span class="va">csa</span>, <span class="va">mca</span><span class="op">)</span></span></code></pre></div>
<pre><code>$cosines
         mca.dim1 mca.dim2 mca.dim3 mca.dim4 mca.dim5 mca.dim1&amp;2 mca.dim1&amp;3
csa.dim1    0.772    0.157   -0.051    0.415    0.486      0.787      0.773
csa.dim2    0.553   -0.481   -0.063   -0.511   -0.535      0.733      0.557
csa.dim3   -0.017   -0.680   -0.059    0.010    0.480      0.680      0.061
csa.dim4    0.223    0.182    0.385   -0.482    0.179      0.287      0.445
csa.dim5   -0.181   -0.296   -0.298   -0.350    0.154      0.347      0.348
         mca.dim1&amp;4 mca.dim1&amp;5 mca.dim2&amp;3 mca.dim2&amp;4 mca.dim2&amp;5 mca.dim3&amp;4
csa.dim1      0.876      0.912      0.165      0.444      0.511      0.418
csa.dim2      0.753      0.770      0.485      0.702      0.719      0.515
csa.dim3      0.020      0.480      0.682      0.680      0.832      0.059
csa.dim4      0.531      0.286      0.426      0.515      0.256      0.617
csa.dim5      0.394      0.238      0.420      0.458      0.334      0.459
         mca.dim3&amp;5 mca.dim4&amp;5
csa.dim1      0.489      0.639
csa.dim2      0.539      0.740
csa.dim3      0.483      0.480
csa.dim4      0.425      0.515
csa.dim5      0.335      0.382

$angles
         mca.dim1 mca.dim2 mca.dim3 mca.dim4 mca.dim5 mca.dim1&amp;2 mca.dim1&amp;3
csa.dim1     39.5     81.0     87.1     65.5     60.9       38.1       39.4
csa.dim2     56.4     61.3     86.4     59.3     57.7       42.9       56.2
csa.dim3     89.0     47.2     86.6     89.4     61.3       47.2       86.5
csa.dim4     77.1     79.5     67.3     61.2     79.7       73.3       63.6
csa.dim5     79.6     72.8     72.7     69.5     81.2       69.7       69.6
         mca.dim1&amp;4 mca.dim1&amp;5 mca.dim2&amp;3 mca.dim2&amp;4 mca.dim2&amp;5 mca.dim3&amp;4
csa.dim1       28.8       24.2       80.5       63.7       59.3       65.3
csa.dim2       41.1       39.7       61.0       45.4       44.0       59.0
csa.dim3       88.9       61.3       47.0       47.2       33.7       86.6
csa.dim4       57.9       73.4       64.8       59.0       75.2       51.9
csa.dim5       66.8       76.3       65.2       62.7       70.5       62.7
         mca.dim3&amp;5 mca.dim4&amp;5
csa.dim1       60.7       50.2
csa.dim2       57.4       42.3
csa.dim3       61.1       61.3
csa.dim4       64.9       59.0
csa.dim5       70.4       67.5</code></pre>
<p>We can see that the first dimension of the CSA is clearly correlated
to the first dimension of the MCA (and very little to the second
dimension), but that the second dimension of the CSA is quite distinct
from the first two dimensions of the MCA.</p>
<p>We will not go further here but let us specify that all the
visualization and interpretation techniques described previously can be
applied to the results of a CSA.</p>
</div>
<div class="section level4">
<h4 id="discriminant-analysis">Discriminant analysis<a class="anchor" aria-label="anchor" href="#discriminant-analysis"></a>
</h4>
<p>The instrumental variables approach is a form of approximation
between geometric data analysis and regression methods. In practice, it
consists of constructing a factorial space, from a first group of active
variables, so that this space “explains” a second set of variables,
called <strong>instrumental variables</strong>, as well as possible. The
term “explain” is used here in a sense similar to analysis of variance
(anova) or regression, in which an explanatory variable “explains” an
explained variable, i.e. accounts for its variance as well as
possible.</p>
<p>In the general case, there are several instrumental variables, which
can be categorical and/or numerical. When the active variables are all
numerical, we speak of Principal Component Analysis on Instrumental
Variables (function <a href="https://nicolas-robette.github.io/GDAtools/reference/PCAiv.html"><code>PCAiv()</code></a>),
and when the active variables are all categorical, of Correspondence
Analysis on Instrumental Variables (function <a href="https://nicolas-robette.github.io/GDAtools/reference/MCAiv.html"><code>MCAiv()</code></a>).</p>
<p>If the instrumental variable is unique and categorical, we can say
that it partitions the individuals into groups or “classes”. It is
therefore a question of carrying out an <strong>inter-class
analysis</strong>, by constructing a factorial space which accounts for
the differences between classes (functions <a href="https://nicolas-robette.github.io/GDAtools/reference/bcPCA.html"><code>bcPCA()</code></a>
for cases where the active variables are continuous and <a href="https://nicolas-robette.github.io/GDAtools/reference/bcMCA.html"><code>bcMCA()</code></a>
for those where they are categorical). It is also sometimes called
<strong>barycentric discriminant analysis</strong> or <em>discriminant
correspondence analysis</em>. If the active variables are continuous, a
variant is the <strong>factorial discriminant analysis</strong> (FDA),
also called <em>descriptive discriminant analysis</em> (function <a href="https://nicolas-robette.github.io/GDAtools/reference/DA.html"><code>DA()</code></a>),
which is equivalent to <em>linear discriminant analysis</em> in the
Anglo-Saxon literature. When the active variables are categorical, an
adaptation of the FDA has been proposed by Gilbert Saporta (1977) under
the name <strong>Disqual</strong> (function <a href="https://nicolas-robette.github.io/GDAtools/reference/DAQ.html"><code>DAQ()</code></a>).</p>
<p>As an example, we apply a barycentric discriminant analysis to
construct the factorial space of the differences in tastes between
individuals of different age categories.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">between</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bcMCA.html">bcMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, class <span class="op">=</span> <span class="va">Taste</span><span class="op">$</span><span class="va">Age</span>, excl <span class="op">=</span> <span class="va">junk</span><span class="op">)</span></span>
<span><span class="fu">factoextra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_ca.html" class="external-link">fviz_ca</a></span><span class="op">(</span><span class="va">between</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>, invisible <span class="op">=</span> <span class="st">"row.sup"</span>, </span>
<span>                    col.col <span class="op">=</span> <span class="st">"dodgerblue3"</span>, col.row <span class="op">=</span> <span class="st">"tomato2"</span>, title <span class="op">=</span> <span class="st">"Between-class analysis"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/between-1.png" width="700"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">between</span><span class="op">$</span><span class="va">ratio</span></span></code></pre></div>
<pre><code>[1] 0.04077871</code></pre>
<p>The first axis, or “discriminant factor”, orders the age categories
and in particular contrasts listening to rap and rock music and taste
for science fiction, on the side of the young, with listening to
classical music and taste for musicals, on the side of the over 50s. But
many of the taste categories are close to the center of axis 1 and are
therefore not differentiated much by age. Age differences account for
only 4% of the total inertia of the cloud.</p>
</div>
<div class="section level4">
<h4 id="conditional-analysis">Conditional analysis<a class="anchor" aria-label="anchor" href="#conditional-analysis"></a>
</h4>
<p><em>Conditional analyses</em> are another attempt to integrate
geometric data analysis and regression. Their principle is to constrain
the axes of the MCA to be independent (i.e. orthogonal) of one or more
supplementary variables, i.e. to construct a MCA “all things (of these
supplementary variables) equal” (Bry et al, 2016). Comparing the results
of the original MCA with those of the conditional MCA is a way to study
structure effects.</p>
<p>In the general case, there are several variables whose effect must be
“eliminated” and these are sometimes called <strong>orthogonal
instrumental variables</strong>. We will therefore carry out a
<em>Principal Component Analysis on Orthogonal Instrumental
Variables</em> if the active variables are all numerical (function <a href="https://nicolas-robette.github.io/GDAtools/reference/PCAoiv.html"><code>PCAoiv()</code></a>)
and a <em>Correspondence Analysis on Orthogonal Instrumental
Variables</em> if the active variables are all categorical (function <a href="https://nicolas-robette.github.io/GDAtools/reference/MCAoiv.html"><code>MCAoiv()</code></a>).</p>
<p>As for the discriminant analyses (previous sub-section), if the
orthogonal instrumental variable is unique and categorical, it
partitions the individuals into “classes”. But this time we are in the
context of an <strong>intra-class analysis</strong>: the aim is to
construct the factorial space that accounts for the structures common to
the different classes. When the active variables are categorical, a
<strong>conditional MCA</strong> (Escofier, 1990 and function <a href="https://nicolas-robette.github.io/GDAtools/reference/wcMCA.html"><code>wcMCA()</code></a>)
is performed, of which the <strong>standardized MCA</strong> (Bry et al,
2016) is an alternative (function <a href="https://nicolas-robette.github.io/GDAtools/reference/stMCA.html"><code>stMCA()</code></a>).
The conditional approach also applies to the case of numerical active
variables (function <a href="https://nicolas-robette.github.io/GDAtools/reference/wcPCA.html"><code>wcPCA()</code></a>).</p>
<p>We now construct the space of tastes common to women and men, or, put
differently, neutralizing the gendered differences. In the plane(1,2),
the results obtained are very similar to those of the MCA. The main
difference concerns the (very female) taste for love movies, which is no
longer distinguishable on axis 2.</p>
<p>The small size of the differences between the two analyses is
confirmed by the fact that the within-class analysis accounts for almost
99% of the total inertia of the cloud.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">within</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wcMCA.html">wcMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, class <span class="op">=</span> <span class="va">Taste</span><span class="op">$</span><span class="va">Gender</span>, excl <span class="op">=</span> <span class="va">junk</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">within</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Within-class analysis"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/within-1.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">within</span><span class="op">$</span><span class="va">ratio</span></span></code></pre></div>
<pre><code>[1] 0.9896936</code></pre>
</div>
<div class="section level4">
<h4 id="symmetrical-multi-table-analysis">Symmetrical multi-table analysis<a class="anchor" aria-label="anchor" href="#symmetrical-multi-table-analysis"></a>
</h4>
<p>Another case arises when the active variables are divided into
several homogeneous groups and these groups play a symmetrical role
(unlike the approaches with instrumental variables).</p>
<p>With two groups of variables, one can perform a <strong>co-inertia
analysis</strong> (Tucker, 1958; Dolédec and Chessel, 1994) in order to
study the structures common to both groups (functions <a href="https://nicolas-robette.github.io/GDAtools/reference/coiMCA.html"><code>coiMCA()</code></a>
if the groups are composed of categorical variables, <a href="https://nicolas-robette.github.io/GDAtools/reference/coiPCA.html"><code>coiPCA()</code></a>
if they are composed of numerical variables).</p>
<p>A co-inertia analysis is applied to a new dataset, in which a group
of 5 variables describes the tastes for different musical genres, and a
second group of 2 variables describes the frequency of listening (in
general or “focused”, i.e. doing nothing else).</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Music</span><span class="op">)</span></span>
<span><span class="va">Xa</span> <span class="op">&lt;-</span> <span class="va">Music</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>  <span class="co"># music tastes</span></span>
<span><span class="va">Xb</span> <span class="op">&lt;-</span> <span class="va">Music</span><span class="op">[</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>  <span class="co"># frequency of listening</span></span>
<span><span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coiMCA.html">coiMCA</a></span><span class="op">(</span><span class="va">Xa</span>, <span class="va">Xb</span>, </span>
<span>               excl.a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FrenchPop.NA"</span>,<span class="st">"Rap.NA"</span>,<span class="st">"Rock.NA"</span>,<span class="st">"Jazz.NA"</span>,<span class="st">"Classical.NA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">factoextra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_ca.html" class="external-link">fviz_ca</a></span><span class="op">(</span><span class="va">coin</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="st">"Co-inertia analysis"</span>,</span>
<span>                    col.col <span class="op">=</span> <span class="st">"dodgerblue3"</span>, col.row <span class="op">=</span> <span class="st">"tomato2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/coinertia-1.png" width="700"></p>
<p>Examination of the first axis shows that rap, jazz and rock are on
the side of daily listening and frequent or daily focused listening,
while taste for French popular music is on the side of non-daily
listening and no focused listening.</p>
<p><strong>Multiple Factor Analysis</strong> (MFA, see Escofier and
Pagès, 1994) makes it possible to deal with two groups of variables
<em>or more</em>. It takes into account both the structures specific to
each group and the structures common to the groups. The function <a href="https://nicolas-robette.github.io/GDAtools/reference/multiMCA.html"><code>multiMCA()</code></a>
makes it possible to carry out MFA using specific MCA or Class Specific
Analysis.</p>
<p>Here, we use the <code>Taste</code> data. One group of variables
describes the listening to music genres and the other the taste for
movie genres, and the MFA uses specific MCAs.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mca1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/speMCA.html">speMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, excl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mca2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/speMCA.html">speMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, excl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">18</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mfa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multiMCA.html">multiMCA</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mca1</span>,<span class="va">mca2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mfa</span>, shapes<span class="op">=</span><span class="cn">FALSE</span>, legend<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Analyse factorielle multiple"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/mfa-1.png" width="700"></p>
<p>We observe that it is mainly the film variables that structure the
plane (1,2). An MFA is of little interest here, because the two spaces
are very little related: the RV coefficient is 1.4% (the <strong>RV
coefficient</strong> - function <a href="https://nicolas-robette.github.io/GDAtools/reference/rvcoef.html"><code>rvcoef()</code></a>
- is a kind of correlation coefficient between groups of variables).</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rvcoef.html">rvcoef</a></span><span class="op">(</span><span class="va">mca1</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span>, <span class="va">mca2</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.01412768</code></pre>
<p>NB: There is another approach to deal with the case of several groups
of variables, whether these groups play a symmetrical role or not, it is
the <strong>PLS approach</strong> (Partial Least Square, see Tenenhaus,
1998). Most of these techniques are available in the package <a href="https://cran.r-project.org/package=plsdepot" class="external-link"><code>plsdepot</code></a>,
developed by <a href="https://github.com/gastonstat" class="external-link">Gaston
Sanchez</a>.</p>
</div>
<div class="section level4">
<h4 id="nonsymmetric-correspondence-analysis">Nonsymmetric correspondence analysis<a class="anchor" aria-label="anchor" href="#nonsymmetric-correspondence-analysis"></a>
</h4>
<p>When dealing with a contingency table with a dependence structure,
i.e. when the role of the two variables is not symmetrical but, on the
contrary, one can be considered as predicting the other, nonsymmetric
correspondence analysis (NSCA) can be used to represent the predictive
structure in the table and to assess the predictive power of the
predictor variable.</p>
<p>Technically, NSCA is very similar to the standard CA, the main
difference being that the columns of the contingency table are not
weighted by their rarity (i.e. the inverse of the marginal
frequencies).</p>
<p>Here we study data on the distribution of various domestic tasks in
couples. We consider that the type of domestic task is predictive of
<em>who</em> performs that task.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">ade4</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">housetasks</span><span class="op">)</span></span>
<span><span class="va">housetasks</span></span></code></pre></div>
<pre><code>           Wife Alternating Husband Jointly
Laundry     156          14       2       4
Main_meal   124          20       5       4
Dinner       77          11       7      13
Breakfeast   82          36      15       7
Tidying      53          11       1      57
Dishes       32          24       4      53
Shopping     33          23       9      55
Official     12          46      23      15
Driving      10          51      75       3
Finances     13          13      21      66
Insurance     8           1      53      77
Repairs       0           3     160       2
Holidays      0           1       6     153</code></pre>
<p>The biplots of an NSCA reflect the dependency structure of the
contingency table and thus should not be interpreted as the planes of a
standard CA. A first principle is that the graph displays the centred
row profiles. A second principle is that the relationships between rows
and columns are contained in their inner products : the rows are
depicted as vectors, also called biplot axes, and the columns are
projected on these vectors. If some columns have projections on the row
vector far away from the origin, then the row has a comparatively large
increase in predictability, and its profile deviates considerably from
the marginal one, especially for that column.</p>
<p>For more detailed interpretational guidelines, see Kroonenberg and
Lombardo (1999, pp.377-378).</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nsCA.html">nsCA</a></span><span class="op">(</span><span class="va">housetasks</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nsca.biplot.html">nsca.biplot</a></span><span class="op">(</span><span class="va">nsca</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/nsca2-1.png" width="700"></p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsca</span><span class="op">$</span><span class="va">GK.tau</span></span></code></pre></div>
<pre><code>[1] 0.4067139</code></pre>
<p>We find that knowing that household tasks involve laundry or meal
preparation “increases predictive performance” of female tasks. Repairs
are associated with male tasks and vacation planning with joint
tasks.</p>
<p>The <strong>Goodman and Kruskal tau</strong> is an
<em>asymmetric</em> measure of global association. Its high value (0.41)
here indicates that the type of household task does predict who performs
the task.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="some-practical-points">Some practical points<a class="anchor" aria-label="anchor" href="#some-practical-points"></a>
</h2>
<div class="section level4">
<h4 id="links-with-other-packages">Links with other packages<a class="anchor" aria-label="anchor" href="#links-with-other-packages"></a>
</h4>
<p>The MCA and PCA variants offered in GDAtools are, as far as possible,
intended to create objects similar to those created by the
<code><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html" class="external-link">PCA()</a></code>, <code><a href="https://rdrr.io/pkg/FactoMineR/man/MCA.html" class="external-link">MCA()</a></code> and <code><a href="https://rdrr.io/pkg/FactoMineR/man/CA.html" class="external-link">CA()</a></code> functions
of the [<code>FactoMineR</code>] package (<a href="https://cran.r-project.org/package=FactoMineR" class="external-link uri">https://cran.r-project.org/package=FactoMineR</a>). This
allows these objects to be (mostly) compatible with a number of
functions for interpreting and visualizing the results:</p>
<ul>
<li><p>the graphical functions of the <a href="https://cran.r-project.org/package=FactoMineR" class="external-link"><code>FactoMineR</code></a>
package,</p></li>
<li><p>the package <a href="https://cran.r-project.org/package=Factoshiny" class="external-link"><code>Factoshiny</code></a>
for the interactive construction of graphs,</p></li>
<li><p>the amazing package <a href="https://juba.github.io/explor/" class="external-link"><code>explor</code></a>, developed
by <a href="https://github.com/juba" class="external-link">Julien Barnier</a>, for interactive
exploration of results,</p></li>
<li><p>the package <a href="https://rpkgs.datanovia.com/factoextra/index.html" class="external-link"><code>factoextra</code></a>
to extract and visualize the results.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="color-customization">Color customization<a class="anchor" aria-label="anchor" href="#color-customization"></a>
</h4>
<p>Most of the graphical functions in <code>GDAtools</code> have been
designed with the “grammar” (and default color palettes) of <a href="https://ggplot2.tidyverse.org/" class="external-link"><code>ggplot2</code></a> in mind,
and in such a way as to be able to customize colors in a very flexible
way. One can indeed use <code>scale_color_*</code> functions, like
<code><a href="https://ggplot2.tidyverse.org/reference/scale_grey.html" class="external-link">scale_color_grey()</a></code> for gray scales,
<code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer()</a></code> for <a href="http://colorbrewer2.%20org/" class="external-link"><code>ColorBrewer</code></a>
palettes, <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual()</a></code> for using custom palettes,
or <code><a href="https://rdrr.io/pkg/paletteer/man/ggplot2-scales-discrete.html" class="external-link">paletteer::scale_color_paletteer_d()</a></code> from the package <a href="https://emilhvitfeldt.github.io/paletteer/" class="external-link"><code>paletteer</code></a>
for accessing a large number of color palettes existing in R (a list of
which is available <a href="https://pmassicotte.github.io/paletteer_gallery/" class="external-link">here</a>).
However, one must be careful to choose a palette with at least as many
colors as there are variables to represent (otherwise some variables
will remain invisible).</p>
<p>For example, to display the cloud of variables with the
<code>ColorBrewer</code> palette “Paired1”, we will proceed as
follows.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mca</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Paired"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GDA_tutorial_files/figure-html/colors-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://github.com/nicolas-robette" class="external-link">Nicolas Robette</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
