<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Geometric Data Analysis with GDAtools • GDAtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Geometric Data Analysis with GDAtools">
<meta property="og:description" content="GDAtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GDAtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Tutorial_GDA.html">Geometric Data Analysis with GDAtools</a>
    </li>
    <li>
      <a href="../articles/Tutorial_descr.html">Descriptive analysis of statistical associations with GDAtools</a>
    </li>
    <li>
      <a href="../articles/french/Tutoriel_AGD.html">L'analyse géométrique des données avec GDAtools</a>
    </li>
    <li>
      <a href="../articles/french/Tutoriel_descr.html">L'analyse descriptive des associations statistiques avec GDAtools</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nicolas-robette/GDAtools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Tutorial_GDA_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Geometric Data Analysis with GDAtools</h1>
                        <h4 class="author">Nicolas Robette</h4>
            
            <h4 class="date">2021-05-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nicolas-robette/GDAtools/blob/master/vignettes/Tutorial_GDA.Rmd"><code>vignettes/Tutorial_GDA.Rmd</code></a></small>
      <div class="hidden name"><code>Tutorial_GDA.Rmd</code></div>

    </div>

    
    
<p><br></p>
<p>This tutorial presents the use of the <code>GDAtools</code> package for geometric data analysis. For more detailed information on the statistical procedures themselves, it is recommended to refer to the books by Henry Rouanet and Brigitte Le Roux:</p>
<p>Le Roux B. and Rouanet H., 2004, <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht.</p>
<p>Le Roux B. and Rouanet H., 2010, <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks.</p>
<hr>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>For this example of Multiple Correspondence Analysis, we will use one of the data sets provided with the package. This is information on the tastes and cultural practices of 2000 individuals: listening to musical genres (French variety, rap, rock, jazz and classical) and taste for film genres (comedy, crime film, animation, science fiction, love film, musical). These 11 variables will be used as “active” variables in the MCA and are completed by 3 “supplementary” variables: gender, age and level of education.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nicolas-robette/GDAtools">GDAtools</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">)</span></code></pre></div>
<pre><code>'data.frame':   2000 obs. of  14 variables:
 $ FrenchPop: Factor w/ 3 levels "No","Yes","NA": 2 1 2 1 2 1 1 1 1 2 ...
 $ Rap      : Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 1 1 1 1 1 1 ...
 $ Rock     : Factor w/ 3 levels "No","Yes","NA": 1 1 2 1 1 2 1 1 2 1 ...
 $ Jazz     : Factor w/ 3 levels "No","Yes","NA": 1 2 1 1 1 1 1 1 1 1 ...
 $ Classical: Factor w/ 3 levels "No","Yes","NA": 1 2 1 2 1 1 1 1 1 1 ...
 $ Comedy   : Factor w/ 3 levels "No","Yes","NA": 1 2 1 1 1 1 2 2 2 2 ...
 $ Crime    : Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 2 1 1 1 1 1 ...
 $ Animation: Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 1 1 1 1 1 1 ...
 $ SciFi    : Factor w/ 3 levels "No","Yes","NA": 2 1 1 1 1 2 1 1 1 1 ...
 $ Love     : Factor w/ 3 levels "No","Yes","NA": 1 1 2 1 1 1 1 1 1 1 ...
 $ Musical  : Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 1 1 1 1 1 1 ...
 $ Gender   : Factor w/ 2 levels "Men","Women": 1 1 2 1 2 2 2 2 1 1 ...
 $ Age      : Factor w/ 3 levels "15-24","25-49",..: 2 3 2 3 2 2 2 2 1 3 ...
 $ Educ     : Factor w/ 4 levels "None","Low","Medium",..: 3 4 3 4 2 1 3 2 2 2 ...</code></pre>
<p><br></p>
<p>The active variables all have a “not available” (“NA”) category, which concerns some individuals. The so-called “specific” MCA makes it possible to neutralise these categories in the construction of the factorial space, while retaining all the individuals.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">==</span><span class="st">"NA"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>FrenchPop       Rap      Rock      Jazz Classical    Comedy     Crime Animation 
       10         9        10        15         5         3        15         4 
    SciFi      Love   Musical 
       12         7        11 </code></pre>
<p><br></p>
<p>We start by identifying the rank of the categories we wish to neutralise.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/getindexcat.html">getindexcat</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code> [1] "FrenchPop.No"  "FrenchPop.Yes" "FrenchPop.NA"  "Rap.No"       
 [5] "Rap.Yes"       "Rap.NA"        "Rock.No"       "Rock.Yes"     
 [9] "Rock.NA"       "Jazz.No"       "Jazz.Yes"      "Jazz.NA"      
[13] "Classical.No"  "Classical.Yes" "Classical.NA"  "Comedy.No"    
[17] "Comedy.Yes"    "Comedy.NA"     "Crime.No"      "Crime.Yes"    
[21] "Crime.NA"      "Animation.No"  "Animation.Yes" "Animation.NA" 
[25] "SciFi.No"      "SciFi.Yes"     "SciFi.NA"      "Love.No"      
[29] "Love.Yes"      "Love.NA"       "Musical.No"    "Musical.Yes"  
[33] "Musical.NA"   </code></pre>
<p><br></p>
<p>The vector of these ranks is then given as an argument to the function <code>speMCA</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/speMCA.html">speMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, excl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">18</span>,<span class="fl">21</span>,<span class="fl">24</span>,<span class="fl">27</span>,<span class="fl">30</span>,<span class="fl">33</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<hr>
</div>
<div id="the-clouds" class="section level1">
<h1 class="hasAnchor">
<a href="#the-clouds" class="anchor"></a>The clouds</h1>
<p>The Benzécri corrected inertia rates give an idea of how much information is represented by each axis.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/modif.rate.html">modif.rate</a></span><span class="op">(</span><span class="va">mca</span><span class="op">)</span><span class="op">$</span><span class="va">modif</span></code></pre></div>
<pre><code>        mrate cum.mrate
1 67.30532896  67.30533
2 22.64536000  89.95069
3  7.17043134  97.12112
4  2.26387669  99.38500
5  0.59232858  99.97733
6  0.02267443 100.00000</code></pre>
<p>It can be seen here that the first two axes capture most of the information (almost 90%). In the following we will therefore concentrate on the plane formed by axes 1 and 2.<br><br></p>
<div id="the-cloud-of-individuals" class="section level3">
<h3 class="hasAnchor">
<a href="#the-cloud-of-individuals" class="anchor"></a>The cloud of individuals</h3>
<p>The cloud of individuals does not have a particular shape (triangle, horseshoe…), the points seem to be distributed in the whole plane.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/cloud_ind-1.png" width="700"></p>
<p>However, in some cases, points may overlap and the structure of the cloud of individuals is only imperfectly rendered by a scatter plot. It is then possible to complete the first graph with a representation of the density of points in the plane. The function <code>ggcloud_indiv</code> allows this to be done using contours or hexagonal areas.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span>, col<span class="op">=</span><span class="st">"lightgray"</span>, density<span class="op">=</span><span class="st">"contour"</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/cloud_ind_contour-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span>, density<span class="op">=</span><span class="st">"hex"</span>, hex.bin<span class="op">=</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/cloud_ind_hex-1.png" width="700"></p>
<p>Whichever density representation is used, it can be seen that the points appear to be more concentrated in an area immediately to the right of the vertical axis.<br><br></p>
</div>
<div id="the-cloud-of-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#the-cloud-of-variables" class="anchor"></a>The cloud of variables</h3>
<p>On the variable cloud,</p>
<ul>
<li><p>Listening to jazz and classical music and liking musicals seem to be opposed to listening to rap and liking comedies on axis 1;</p></li>
<li><p>Taste for animation and science fiction to taste for love films and musicals on axis 2.</p></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mca</span>, shapes<span class="op">=</span><span class="cn">FALSE</span>, legend<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/cloud_var-1.png" width="700"></p>
<p>However, to be robust, the interpretation of the factorial plane cannot stop at a visual examination of the cloud of variables. This must be complemented by the careful analysis of statistical indicators, in particular the <em>contributions</em> of the categories to the construction of the axes.</p>
<hr>
</div>
</div>
<div id="aids-to-interpretation" class="section level1">
<h1 class="hasAnchor">
<a href="#aids-to-interpretation" class="anchor"></a>Aids to interpretation</h1>
<p>Most of the aids to interpretation and other useful information are present in the object created by <code>speMCA</code>. The package offers several functions to easily extract this information.</p>
<ul>
<li>
<code>contrib</code> presents the contributions of the variables and the categories of these variables to the construction of each of the axes and to that of the cloud.</li>
<li>
<code>dimcontrib</code> extracts the contributions of individuals and variable categories to the construction of a particular axis.</li>
<li>
<code>dimdescr</code> identifies the variables and variable categories most statistically associated with the different axes. The measures of association used are the <em>etas²</em> for the variables and the <em>correlation coefficients</em> for the categories.</li>
</ul>
<p>The <code>tabcontrib</code> function allows, for a given axis, to summarise the main contributions (only contributions above the average are presented).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">mca</span>, dim<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">var</th>
<th align="left">moda</th>
<th align="left">ctr1</th>
<th align="left">ctr2</th>
<th align="right">weight</th>
<th align="left">ctrtot</th>
<th align="left">cumctrtot</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Classical</td>
<td align="left">Yes</td>
<td align="left">-23.08</td>
<td align="left"></td>
<td align="right">552</td>
<td align="left">31.88</td>
<td align="left">31.88</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="left"></td>
<td align="left">8.8</td>
<td align="right">1443</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Jazz</td>
<td align="left">Yes</td>
<td align="left">-25.49</td>
<td align="left"></td>
<td align="right">364</td>
<td align="left">31.15</td>
<td align="left">63.03</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="left"></td>
<td align="left">5.66</td>
<td align="right">1621</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Comedy</td>
<td align="left">No</td>
<td align="left">-7.22</td>
<td align="left"></td>
<td align="right">1141</td>
<td align="left">16.88</td>
<td align="left">79.91</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Yes</td>
<td align="left"></td>
<td align="left">9.66</td>
<td align="right">856</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>The classical music and jazz listening variables alone contribute over 60% to the construction of axis 1. Listening to classical music and jazz is therefore opposed to not listening to them, and secondarily to a taste for comedy.<br><br></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">mca</span>, dim<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">var</th>
<th align="left">moda</th>
<th align="left">ctr1</th>
<th align="left">ctr2</th>
<th align="right">weight</th>
<th align="left">ctrtot</th>
<th align="left">cumctrtot</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Rock</td>
<td align="left">No</td>
<td align="left">-4.78</td>
<td align="left"></td>
<td align="right">1455</td>
<td align="left">17.77</td>
<td align="left">17.77</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Yes</td>
<td align="left"></td>
<td align="left">12.99</td>
<td align="right">535</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Love</td>
<td align="left">Yes</td>
<td align="left">-17.24</td>
<td align="left"></td>
<td align="right">225</td>
<td align="left">17.24</td>
<td align="left">35.01</td>
</tr>
<tr class="even">
<td align="left">FrenchPop</td>
<td align="left">Yes</td>
<td align="left">-5.69</td>
<td align="left"></td>
<td align="right">1249</td>
<td align="left">15.38</td>
<td align="left">50.39</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">No</td>
<td align="left"></td>
<td align="left">9.69</td>
<td align="right">741</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Musical</td>
<td align="left">Yes</td>
<td align="left">-14.33</td>
<td align="left"></td>
<td align="right">66</td>
<td align="left">14.33</td>
<td align="left">64.72</td>
</tr>
<tr class="odd">
<td align="left">SciFi</td>
<td align="left">Yes</td>
<td align="left"></td>
<td align="left">11.49</td>
<td align="right">143</td>
<td align="left">11.49</td>
<td align="left">76.21</td>
</tr>
<tr class="even">
<td align="left">Rap</td>
<td align="left">Yes</td>
<td align="left"></td>
<td align="left">11.05</td>
<td align="right">261</td>
<td align="left">11.05</td>
<td align="left">87.26</td>
</tr>
</tbody>
</table>
<p>On axis 2, listening to rock and rap music and a taste for science fiction films are opposed to a taste for love films and musicals and listening to French pop music.</p>
<hr>
</div>
<div id="structuring-factors" class="section level1">
<h1 class="hasAnchor">
<a href="#structuring-factors" class="anchor"></a>Structuring factors</h1>
<div id="the-supplementary-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#the-supplementary-variables" class="anchor"></a>The supplementary variables</h3>
<p>We can go further by studying the relationship between the factorial plane and the supplementary variables, in this case gender, age and education. A first step is to project the supplementary variables onto the cloud of variables.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mca</span>, shapes<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggadd_supvar.html">ggadd_supvar</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Age</span>, col<span class="op">=</span><span class="st">"dodgerblue3"</span>, shape<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggadd_supvar.html">ggadd_supvar</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, col<span class="op">=</span><span class="st">"tomato"</span>, shape<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>
<span class="fu"><a href="../reference/ggadd_supvar.html">ggadd_supvar</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Gender</span>, col<span class="op">=</span><span class="st">"seagreen"</span>, shape<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/cloud_varsup-1.png" width="700"></p>
<p>Level of education appears to be primarily associated with axis 1, with the most educated on the side of jazz and classical listening. Gender seems to be linked only to axis 2, with women at the bottom of the plane and men at the top. Age is associated with both axes, with individuals moving from the north-east quadrant to the south-west quadrant as their age increases.<br><br></p>
<p>These initial observations can be confirmed statistically by measuring the degree of association between the supplementary variables and the axes using the <em>eta²</em> indicator.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dimeta2.html">dimeta2</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>       dim.1 dim.2
Gender   0.0   6.0
Age      3.8  14.2
Educ     5.9   3.3</code></pre>
<p>Education is the supplementary variable most associated with axis 1: it ‘explains 5.9% of the variance in individual coordinates’ on this axis. Age is also associated with the first axis, but to a lesser extent, and gender not at all.</p>
<p>On axis 2, age is the most structuring variable, ahead of gender and education level. We can also see that age is clearly more closely linked to axis 2 than to axis 1.<br><br></p>
<p>At the level of the categories, the association of a supplementary variable category with an axis can be characterised from the <em>correlation coefficients</em>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dimdescr.html">dimdescr</a></span><span class="op">(</span><span class="va">mca</span>, vars<span class="op">=</span><span class="va">Taste</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">dim.1</span><span class="op">$</span><span class="va">categories</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">categories</th>
<th align="right">median.y.in.xcat</th>
<th align="right">median.y.global</th>
<th align="right">mad.y.in.xcat</th>
<th align="right">mad.y.global</th>
<th align="right">cor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age.15-24</td>
<td align="right">0.204</td>
<td align="right">0.062</td>
<td align="right">0.215</td>
<td align="right">0.248</td>
<td align="right">0.176</td>
</tr>
<tr class="even">
<td align="left">Educ.None</td>
<td align="right">0.141</td>
<td align="right">0.062</td>
<td align="right">0.191</td>
<td align="right">0.248</td>
<td align="right">0.145</td>
</tr>
<tr class="odd">
<td align="left">Educ.Low</td>
<td align="right">0.104</td>
<td align="right">0.062</td>
<td align="right">0.224</td>
<td align="right">0.248</td>
<td align="right">0.100</td>
</tr>
<tr class="even">
<td align="left">Age.25-49</td>
<td align="right">0.069</td>
<td align="right">0.062</td>
<td align="right">0.224</td>
<td align="right">0.248</td>
<td align="right">0.015</td>
</tr>
<tr class="odd">
<td align="left">Gender.Women</td>
<td align="right">0.067</td>
<td align="right">0.062</td>
<td align="right">0.244</td>
<td align="right">0.248</td>
<td align="right">0.012</td>
</tr>
<tr class="even">
<td align="left">Gender.Men</td>
<td align="right">0.057</td>
<td align="right">0.062</td>
<td align="right">0.252</td>
<td align="right">0.248</td>
<td align="right">-0.012</td>
</tr>
<tr class="odd">
<td align="left">Educ.Medium</td>
<td align="right">0.014</td>
<td align="right">0.062</td>
<td align="right">0.272</td>
<td align="right">0.248</td>
<td align="right">-0.051</td>
</tr>
<tr class="even">
<td align="left">Age.50+</td>
<td align="right">0.001</td>
<td align="right">0.062</td>
<td align="right">0.270</td>
<td align="right">0.248</td>
<td align="right">-0.142</td>
</tr>
<tr class="odd">
<td align="left">Educ.High</td>
<td align="right">-0.098</td>
<td align="right">0.062</td>
<td align="right">0.273</td>
<td align="right">0.248</td>
<td align="right">-0.213</td>
</tr>
</tbody>
</table>
<p>On axis 1, those with no or few qualifications and those aged 15-24 are opposed to those with more qualifications and those aged 50 and over. The other categories appear to have little connection with the axis (their correlation coefficients are close to 0).<br><br></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/condesc.html">condesc</a></span><span class="op">(</span><span class="va">mca</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">Taste</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">categories</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">categories</th>
<th align="right">median.y.in.xcat</th>
<th align="right">median.y.global</th>
<th align="right">mad.y.in.xcat</th>
<th align="right">mad.y.global</th>
<th align="right">cor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age.15-24</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.288</td>
</tr>
<tr class="even">
<td align="left">Gender.Men</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.245</td>
</tr>
<tr class="odd">
<td align="left">Age.25-49</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.123</td>
</tr>
<tr class="even">
<td align="left">Educ.High</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.123</td>
</tr>
<tr class="odd">
<td align="left">Educ.Low</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.034</td>
</tr>
<tr class="even">
<td align="left">Educ.Medium</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.009</td>
</tr>
<tr class="odd">
<td align="left">Educ.None</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-0.167</td>
</tr>
<tr class="even">
<td align="left">Gender.Women</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-0.245</td>
</tr>
<tr class="odd">
<td align="left">Age.50+</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-0.330</td>
</tr>
</tbody>
</table>
<p>On axis 2, men, the under 50s and the more educated are opposed to women, the over 50s and the uneducated.</p>
</div>
<div id="analysis-of-one-supplementary-variable" class="section level3">
<h3 class="hasAnchor">
<a href="#analysis-of-one-supplementary-variable" class="anchor"></a>Analysis of one supplementary variable</h3>
<p>Let us continue the analysis by focusing on one supplementary variable, the level of education. The <code>varsup</code> function provides the coordinates of the categories on the axes, their <em>cosinus²</em> (which gives the quality of representation of a category on an axis), their dispersions on the axes, the <em>eta²</em> and the <em>typicality tests</em> (to which we will return in the next section).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/varsup.html">varsup</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">)</span></code></pre></div>
<pre><code>$weight
  None    Low Medium   High 
   490    678    357    475 

$coord
           dim.1     dim.2     dim.3     dim.4     dim.5
None    0.254716 -0.293253 -0.191563  0.094510 -0.050520
Low     0.140147  0.046951  0.002259 -0.063613 -0.044181
Medium -0.109057  0.019669  0.054436  0.070183 -0.027962
High   -0.380835  0.220714  0.153475 -0.059443  0.136194

$cos2
          dim.1    dim.2    dim.3    dim.4    dim.5
None   0.021054 0.027906 0.011908 0.002899 0.000828
Low    0.010073 0.001131 0.000003 0.002075 0.001001
Medium 0.002584 0.000084 0.000644 0.001070 0.000170
High   0.045175 0.015173 0.007337 0.001101 0.005777

$var
           dim.1    dim.2    dim.3    dim.4    dim.5
None    0.104915 0.116125 0.115232 0.103800 0.086031
Low     0.125921 0.116092 0.109029 0.087945 0.087735
Medium  0.141298 0.112505 0.097031 0.102449 0.094541
High    0.145983 0.107170 0.091066 0.106049 0.113352
within  0.128284 0.113341 0.104141 0.098718 0.094616
between 0.008061 0.003923 0.001598 0.000524 0.000555
total   0.136345 0.117264 0.105739 0.099242 0.095172
eta2    0.059123 0.033455 0.015115 0.005279 0.005832

$typic
           dim.1     dim.2     dim.3     dim.4     dim.5
None    6.487410 -7.468929 -4.878958  2.407110 -1.286704
Low     4.487336  1.503312  0.072336 -2.036827 -1.414633
Medium -2.272883  0.409932  1.134503  1.462690 -0.582753
High   -9.502876  5.507427  3.829615 -1.483270  3.398406

$pval
          dim.1    dim.2    dim.3    dim.4    dim.5
None   0.000000 0.000000 0.000001 0.016079 0.198197
Low    0.000007 0.132758 0.942334 0.041667 0.157176
Medium 0.023033 0.681856 0.256584 0.143552 0.560059
High   0.000000 0.000000 0.000128 0.138003 0.000678

$cor
        dim.1  dim.2  dim.3  dim.4  dim.5
None    0.145 -0.167 -0.109  0.054 -0.029
Low     0.100  0.034  0.002 -0.046 -0.032
Medium -0.051  0.009  0.025  0.033 -0.013
High   -0.213  0.123  0.086 -0.033  0.076</code></pre>
<p><br></p>
<p>Graphically, we can represent the “subcloud” of each of the categories with the help of a <em>concentration ellipse</em>, which is centred on the mean point and encompasses 86% of the individuals having this category.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span>, col<span class="op">=</span><span class="st">'lightgrey'</span><span class="op">)</span>
<span class="fu"><a href="../reference/ggadd_kellipses.html">ggadd_kellipses</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, label<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/educ_ellipses-1.png" width="700"></p>
<p>Even though, as we have seen, the education level categories are ordered along axis 1, the subclouds overlap to a very large extent, as the association between the variable and the axis is moderate.<br><br></p>
<p>Let us now look more specifically at the subcloud of the most highly educated individuals.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggadd_kellipses.html">ggadd_kellipses</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, sel<span class="op">=</span><span class="fl">4</span>, legend<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/educ_ellipse-1.png" width="700"></p>
<p>A concentration ellipse is useful because it represents both the mean point of the category and the dispersion of the subcloud along the axes. Here we see that although the mean point of the most highly educated individuals is located in the northwest quadrant, a significant proportion of the points in the subcloud are to the right and/or bottom of the plane.</p>
<p>The concentration ellipses, on the other hand, give only an imperfect representation of the distribution of the points of the subcloud, because of the possible overlapping of the points (in a similar way to what we saw for the cloud of the individuals) and its centring on the mean point. It can therefore be interesting to complete a concentration ellipse with a representation of the density of the points of the subcloud, in the form of contours or areas.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggadd_density.html">ggadd_density</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mca</span>, var<span class="op">=</span><span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, cat<span class="op">=</span><span class="st">"High"</span>, density<span class="op">=</span><span class="st">"contour"</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/educ_contour-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggadd_density.html">ggadd_density</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mca</span>, var<span class="op">=</span><span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, cat<span class="op">=</span><span class="st">"High"</span>, density<span class="op">=</span><span class="st">"area"</span>, ellipse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/educ_area-1.png" width="700"></p>
<p>Here we see that there appears to be a concentration of highly educated individuals immediately to the right of the vertical axis, in an area that also corresponds to a concentration of points in the cloud of individuals (see above).</p>
<p>A further step in the analysis consists in neutralising the influence of the distribution of points in the cloud of individuals on that of the subcloud, by asking in which parts of the plane the most highly educated are over/under represented. This is possible using a <em>heat map</em>, by measuring in each tile the correlation coefficient between having a high level of education and being located in the tile rather than in the rest of the plane.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggadd_corr.html">ggadd_corr</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mca</span>, var<span class="op">=</span><span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, cat<span class="op">=</span><span class="st">"High"</span>, xbins<span class="op">=</span><span class="fl">20</span>, ybins<span class="op">=</span><span class="fl">20</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/educ_corr-1.png" width="700"></p>
<p>The most highly educated individuals are over-represented in the northwest quadrant as a whole, but also among the westernmost in the southwest quadrant.</p>
<p>Note that we can also represent the subclouds corresponding to the categories of a supplementary variable using <em>convex hulls</em>. A convex hull is the smallest convex polygon among those containing a set of points. In the context of GDA, convex hulls are an interesting graphical representation especially if the represented subclouds are relatively little overlapped. This is the case, for example, if we perform a partition of individuals in a plane using automatic clustering. Here, we apply hierarchical ascending clustering to the coordinates of the individuals in the plane 1-2 and we identify 3 clusters.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">mca</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">hca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"ward.D2"</span><span class="op">)</span>
<span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">hca</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/ggadd_chulls.html">ggadd_chulls</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mca</span>, <span class="va">cluster</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/chull-1.png" width="700"></p>
</div>
<div id="interaction-between-two-supplementary-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#interaction-between-two-supplementary-variables" class="anchor"></a>Interaction between two supplementary variables</h3>
<p>Interactions between several supplementary variables can also be studied, for example here between gender and age.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mca</span>, col<span class="op">=</span><span class="st">'lightgrey'</span>, shapes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/ggadd_interaction.html">ggadd_interaction</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Gender</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Age</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tomato3"</span>,<span class="st">"dodgerblue3"</span><span class="op">)</span>, legend<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/interaction-1.png" width="700"></p>
<p>Gender and age seem to interact little in the 1-2 plane. However, it can be seen that on axis 1, the differences between the youngest and the oldest are greater for women than for men, and that on axis 2, the youngest differ more by gender than the oldest.</p>
<hr>
</div>
</div>
<div id="inductive-data-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#inductive-data-analysis" class="anchor"></a>Inductive data analysis</h1>
<p>If one wishes to assess the generalizability of the results, one can complement the above descriptive analyses with statistical inference procedures that borrow from inductive data analysis and combinatorial approaches (for this part even more than for the others, we refer to Le Roux and Rouanet, 2004 &amp; 2010).</p>
<p>The typicality problem consists in asking whether a group of individuals can be assimilated to the reference population or whether it is atypical. A <em>typicality test</em> calculates a <em>combinatorial p-value</em>, which defines the “degree of typicality” of the mean point of the group of individuals. A low p-value is considered statistically significant in the combinatorial sense and reflects a difference that is probably not due to chance.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dimtypicality.html">dimtypicality</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, max.pval<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></code></pre></div>
<pre><code>$dim.1
            weight test.stat p.value
Age.15-24      297  7.890052 0.00000
Educ.None      490  6.487410 0.00000
Educ.Low       678  4.487336 0.00001
Educ.Medium    357 -2.272883 0.02303
Age.50+        854 -6.340738 0.00000
Educ.High      475 -9.502876 0.00000

$dim.2
             weight  test.stat p.value
Age.15-24       297  12.875430       0
Gender.Men      958  10.972527       0
Age.25-49       849   5.520379       0
Educ.High       475   5.507427       0
Educ.None       490  -7.468929       0
Gender.Women   1042 -10.972527       0
Age.50+         854 -14.772247       0</code></pre>
<p>At a 5% level, the mean points of women, men and middle-aged people are not significantly different from that of the whole population on axis 1 (i.e. 0). On axis 2, it is the mean points of the low and medium levels of education that do not differ significantly from the origin.</p>
<p>The results of the typicality tests for a particular supplementary variable can be studied using the <code>varsup</code> function.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vseduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/varsup.html">varsup</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">)</span>
<span class="va">vseduc</span><span class="op">$</span><span class="va">pval</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>          dim.1    dim.2
None   0.000000 0.000000
Low    0.000007 0.132758
Medium 0.023033 0.681856
High   0.000000 0.000000</code></pre>
<p>We can see that, on axis 1, all the education level categories are significantly different from 0 at a level of 5%, they are atypical of the whole cloud of individuals, but that this is not the case for the “low” and “medium” categories on axis 2.</p>
<p>The confidence ellipses follow the same logic as the typicality tests. With a conventional significance threshold of 5%, the confidence ellipse is a 95% confidence zone representing all the possible mean points of a category that are not significantly different from the observed mean point.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span>, col<span class="op">=</span><span class="st">'lightgrey'</span><span class="op">)</span>
<span class="fu"><a href="../reference/ggadd_ellipses.html">ggadd_ellipses</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, level<span class="op">=</span><span class="fl">0.05</span>, label<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/educ_conc_ellipses-1.png" width="700"></p>
<p>A homogeneity test is a combinatorial procedure that aims to compare several groups of individuals. The question asked is whether, on a given axis, the positions of two groups are significantly different.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/homog.test.html">homog.test</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">)</span>
<span class="va">ht</span><span class="op">$</span><span class="va">dim.1</span><span class="op">$</span><span class="va">p.values</span></code></pre></div>
<pre><code>               None          Low Medium High
None   1.000000e+00 1.680934e-07      0    0
Low    1.680934e-07 1.000000e+00      0    0
Medium 0.000000e+00 0.000000e+00      1    0
High   0.000000e+00 0.000000e+00      0    1</code></pre>
<p>On axis 1, the mean points of the education level categories are all significantly different from each other (the p-values are all very close to 0).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht</span><span class="op">$</span><span class="va">dim.2</span><span class="op">$</span><span class="va">p.values</span></code></pre></div>
<pre><code>       None       Low    Medium High
None      1 0.0000000 0.0000000    0
Low       0 1.0000000 0.2232064    0
Medium    0 0.2232064 1.0000000    0
High      0 0.0000000 0.0000000    1</code></pre>
<p>This is not the case on axis 2, where the “low” and “medium” categories do not differ significantly (p-value=0.22).</p>
<hr>
</div>
<div id="class-specific-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#class-specific-analysis" class="anchor"></a>Class Specific Analysis</h1>
<p><em>Class Specific Analysis</em> (CSA) is an extension of MCA which allows the study of a subcloud of individuals by taking into account the distribution of variables in the subcloud and in the whole cloud. It is thus a question of taking into account the fact that the structure of the subcloud does not exist <em>in abstracto</em> but in relation to the cloud in which it is included.</p>
<p>CSA is illustrated here using the subcloud of the most highly educated individuals.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">csa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/csMCA.html">csMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">==</span><span class="st">"High"</span>, excl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">18</span>,<span class="fl">21</span>,<span class="fl">24</span>,<span class="fl">27</span>,<span class="fl">30</span>,<span class="fl">33</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">csa</span>, shapes<span class="op">=</span><span class="cn">FALSE</span>, legend<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/csa_cloud_var-1.png" width="700"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">csa</span>, dim<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">var</th>
<th align="left">moda</th>
<th align="left">ctr1</th>
<th align="left">ctr2</th>
<th align="right">weight</th>
<th align="left">ctrtot</th>
<th align="left">cumctrtot</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Jazz</td>
<td align="left">Yes</td>
<td align="left">-41.85</td>
<td align="left"></td>
<td align="right">145</td>
<td align="left">51.08</td>
<td align="left">51.08</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="left"></td>
<td align="left">9.23</td>
<td align="right">326</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Classical</td>
<td align="left">Yes</td>
<td align="left">-17.79</td>
<td align="left"></td>
<td align="right">183</td>
<td align="left">24.55</td>
<td align="left">75.63</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="left"></td>
<td align="left">6.76</td>
<td align="right">290</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Animation</td>
<td align="left">Yes</td>
<td align="left"></td>
<td align="left">12.43</td>
<td align="right">34</td>
<td align="left">12.43</td>
<td align="left">88.06</td>
</tr>
</tbody>
</table>
<p>We can see that, as in the MCA, listening to jazz and classical music structure axis 1, but this time much more strongly since these two variables alone contribute 75% to the construction of the axis.<br><br></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">csa</span>, dim<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">var</th>
<th align="left">moda</th>
<th align="left">ctr1</th>
<th align="left">ctr2</th>
<th align="right">weight</th>
<th align="left">ctrtot</th>
<th align="left">cumctrtot</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Animation</td>
<td align="left">Yes</td>
<td align="left">-59.05</td>
<td align="left"></td>
<td align="right">34</td>
<td align="left">59.05</td>
<td align="left">59.05</td>
</tr>
<tr class="even">
<td align="left">SciFi</td>
<td align="left">Yes</td>
<td align="left">-9.51</td>
<td align="left"></td>
<td align="right">38</td>
<td align="left">9.51</td>
<td align="left">68.56</td>
</tr>
<tr class="odd">
<td align="left">Rock</td>
<td align="left">Yes</td>
<td align="left">-6.71</td>
<td align="left"></td>
<td align="right">203</td>
<td align="left">6.71</td>
<td align="left">75.27</td>
</tr>
<tr class="even">
<td align="left">Jazz</td>
<td align="left">Yes</td>
<td align="left">-5.43</td>
<td align="left"></td>
<td align="right">145</td>
<td align="left">5.43</td>
<td align="left">80.7</td>
</tr>
</tbody>
</table>
<p>It is above all the taste for animation movies that contributes to the construction of axis 2, which may be explained in part by the small number of this category.</p>
<p>Finally, the subcloud of the variables for the most highly educated people has points in common with that of the population as a whole, but also some very marked specificities.</p>
<p>We will not go any further here, but it should be noted that all the techniques described above can be applied to the results of a CSA.</p>
<hr>
</div>
<div id="standardized-mca" class="section level1">
<h1 class="hasAnchor">
<a href="#standardized-mca" class="anchor"></a>Standardized MCA</h1>
<p><em>Standardized MCA</em> is an attempt to integrate geometric data analysis and regression. Its principle consists in constraining the axes of the MCA to be independent (i.e. orthogonal) to a supplementary variable, i.e. to construct a MCA “all other things (about this supplementary variable) being equal” (Bry et al, 2016). Comparing the space of the original MCA with that of the standardized MCA is a way to study structural effects.</p>
<p>Here, when we “control” the MCA by education level, which is associated with axis 1, we find, for example, that tastes for romance movies and musicals, which are more popular with women, shift to the left of the plane.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stmca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stMCA.html">stMCA</a></span><span class="op">(</span><span class="va">mca</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">stmca</span>, shapes<span class="op">=</span><span class="cn">FALSE</span>, legend<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/st_mca-1.png" width="700"></p>
<hr>
</div>
<div id="multiple-factor-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#multiple-factor-analysis" class="anchor"></a>Multiple Factor Analysis</h1>
<p><code>GDAtools</code> also allows to perform Multiple Factor Analysis (MFA) using specific MCAs or Class Specific Analysis.</p>
<p>Here, one group of variables describes the listening to music genres and the other the taste for movie genres, and the MFA uses specific MCAs. We observe that it is the film variables that structure the plane 1-2.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mca1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/speMCA.html">speMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,excl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span>
<span class="va">mca2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/speMCA.html">speMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>,excl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">18</span><span class="op">)</span><span class="op">)</span>
<span class="va">mfa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multiMCA.html">multiMCA</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mca1</span>,<span class="va">mca2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mfa</span>, shapes<span class="op">=</span><span class="cn">FALSE</span>, legend<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_GDA_files/figure-html/mfa-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/nicolas-robette">Nicolas Robette</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
