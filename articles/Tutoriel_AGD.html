<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>L'analyse géométrique des données avec GDAtools • GDAtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="L'analyse géométrique des données avec GDAtools">
<meta property="og:description" content="GDAtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GDAtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/GDA_tutorial.html">Geometric Data Analysis with GDAtools</a>
    </li>
    <li>
      <a href="../articles/Tutoriel_AGD.html">L'analyse géométrique des données avec GDAtools</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nicolas-robette/GDAtools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Tutoriel_AGD_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>L’analyse géométrique des données avec GDAtools</h1>
                        <h4 data-toc-skip class="author">Nicolas Robette</h4>
            
            <h4 data-toc-skip class="date">2023-04-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nicolas-robette/GDAtools/blob/HEAD/vignettes/articles/Tutoriel_AGD.Rmd" class="external-link"><code>vignettes/articles/Tutoriel_AGD.Rmd</code></a></small>
      <div class="hidden name"><code>Tutoriel_AGD.Rmd</code></div>

    </div>

    
    
<p><br>
Ce tutoriel présente l’utilisation du package <code>GDAtools</code> pour l’analyse géométrique des données. Pour des approfondissements sur les procédures statistiques elles-mêmes, il est recommandé de se référer aux ouvrages référencés sur la page d’accueil du site.</p>
<hr>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Pour cet exemple d’Analyse des Correspondances Multiples (ACM), nous allons utiliser l’un des jeux de données fournis avec le package. Il s’agit d’informations sur les goûts et les pratiques culturelles de 2000 individus : écoute de genres musicaux (variété française, rap, rock, jazz et classique) et goût pour des genres de films (comédie, film policier, animation, science-fiction, film d’amour, comédie musicale). Ces 11 variables serviront de variables “actives” dans l’ACM et sont complétées par 3 variables “supplémentaires” : le sexe, l’âge et le niveau d’éducation.<br></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>  <span class="co"># pour les graphiques</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nicolas-robette/GDAtools" class="external-link">GDAtools</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   2000 obs. of  14 variables:
 $ FrenchPop: Factor w/ 3 levels "No","Yes","NA": 2 1 2 1 2 1 1 1 1 2 ...
 $ Rap      : Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 1 1 1 1 1 1 ...
 $ Rock     : Factor w/ 3 levels "No","Yes","NA": 1 1 2 1 1 2 1 1 2 1 ...
 $ Jazz     : Factor w/ 3 levels "No","Yes","NA": 1 2 1 1 1 1 1 1 1 1 ...
 $ Classical: Factor w/ 3 levels "No","Yes","NA": 1 2 1 2 1 1 1 1 1 1 ...
 $ Comedy   : Factor w/ 3 levels "No","Yes","NA": 1 2 1 1 1 1 2 2 2 2 ...
 $ Crime    : Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 2 1 1 1 1 1 ...
 $ Animation: Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 1 1 1 1 1 1 ...
 $ SciFi    : Factor w/ 3 levels "No","Yes","NA": 2 1 1 1 1 2 1 1 1 1 ...
 $ Love     : Factor w/ 3 levels "No","Yes","NA": 1 1 2 1 1 1 1 1 1 1 ...
 $ Musical  : Factor w/ 3 levels "No","Yes","NA": 1 1 1 1 1 1 1 1 1 1 ...
 $ Gender   : Factor w/ 2 levels "Men","Women": 1 1 2 1 2 2 2 2 1 1 ...
 $ Age      : Factor w/ 3 levels "15-24","25-49",..: 2 3 2 3 2 2 2 2 1 3 ...
 $ Educ     : Factor w/ 4 levels "None","Low","Medium",..: 3 4 3 4 2 1 3 2 2 2 ...</code></pre>
<p><br>
Les variables actives ont toutes une modalité “non-réponse” (“NA”), qui concerne quelques individus.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code> FrenchPop   Rap        Rock       Jazz      Classical  Comedy     Crime     
 No : 741   No :1730   No :1455   No :1621   No :1443   No :1141   No :1430  
 Yes:1249   Yes: 261   Yes: 535   Yes: 364   Yes: 552   Yes: 856   Yes: 555  
 NA :  10   NA :   9   NA :  10   NA :  15   NA :   5   NA :   3   NA :  15  
 Animation  SciFi       Love      Musical   
 No :1905   No :1845   No :1768   No :1923  
 Yes:  91   Yes: 143   Yes: 225   Yes:  66  
 NA :   4   NA :  12   NA :   7   NA :  11  </code></pre>
<p><br>
L’<strong>ACM spécifique</strong> permet de neutraliser ces modalités dans la construction de l’espace factoriel, tout en conservant l’ensemble des individus. On commence par repérer le rang des modalités que l’on souhaite neutraliser.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getindexcat.html">getindexcat</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] "FrenchPop.No"  "FrenchPop.Yes" "FrenchPop.NA"  "Rap.No"       
 [5] "Rap.Yes"       "Rap.NA"        "Rock.No"       "Rock.Yes"     
 [9] "Rock.NA"       "Jazz.No"       "Jazz.Yes"      "Jazz.NA"      
[13] "Classical.No"  "Classical.Yes" "Classical.NA"  "Comedy.No"    
[17] "Comedy.Yes"    "Comedy.NA"     "Crime.No"      "Crime.Yes"    
[21] "Crime.NA"      "Animation.No"  "Animation.Yes" "Animation.NA" 
[25] "SciFi.No"      "SciFi.Yes"     "SciFi.NA"      "Love.No"      
[29] "Love.Yes"      "Love.NA"       "Musical.No"    "Musical.Yes"  
[33] "Musical.NA"   </code></pre>
<p><br>
Le vecteur de ces rangs est ensuite donné comme argument dans la fonction d’ACM spécifique <a href="https://nicolas-robette.github.io/GDAtools/reference/speMCA.html"><code>speMCA()</code></a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/speMCA.html">speMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, excl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">18</span>,<span class="fl">21</span>,<span class="fl">24</span>,<span class="fl">27</span>,<span class="fl">30</span>,<span class="fl">33</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Alternativement, on peut utiliser la liste des <em>intitulés</em> des modalités “poubelles”.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">junk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FrenchPop.NA"</span>, <span class="st">"Rap.NA"</span>, <span class="st">"Rock.NA"</span>, <span class="st">"Jazz.NA"</span>, <span class="st">"Classical.NA"</span>,</span>
<span>          <span class="st">"Comedy.NA"</span>, <span class="st">"Crime.NA"</span>, <span class="st">"Animation.NA"</span>, <span class="st">"SciFi.NA"</span>, <span class="st">"Love.NA"</span>, </span>
<span>          <span class="st">"Musical.NA"</span><span class="op">)</span></span>
<span><span class="va">mca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/speMCA.html">speMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, excl <span class="op">=</span> <span class="va">junk</span><span class="op">)</span></span></code></pre></div>
<p>Les intitulés de ces modalités peuvent être identifiés à l’aide de la fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/ijunk.html"><code>ijunk()</code></a>, qui lance une application interactive prévue à cet effet et qui permet de copier-coller le code approprié.</p>
<hr>
</div>
<div class="section level2">
<h2 id="les-nuages">Les nuages<a class="anchor" aria-label="anchor" href="#les-nuages"></a>
</h2>
<p>Les taux d’inertie corrigés de Benzécri permettent de se faire une idée de la part d’information représentée par chacun des axes.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/modif.rate.html">modif.rate</a></span><span class="op">(</span><span class="va">mca</span><span class="op">)</span><span class="op">$</span><span class="va">modif</span></span></code></pre></div>
<pre><code>        mrate cum.mrate
1 67.30532896  67.30533
2 22.64536000  89.95069
3  7.17043134  97.12112
4  2.26387669  99.38500
5  0.59232858  99.97733
6  0.02267443 100.00000</code></pre>
<p>On voit ici que les deux premiers axes capturent l’essentiel de l’information (près de 90 %). On va donc dans la suite se concentrer sur le plan formé par les axes 1 et 2.<br><br></p>
<div class="section level4">
<h4 id="nuage-des-individus">Nuage des individus<a class="anchor" aria-label="anchor" href="#nuage-des-individus"></a>
</h4>
<p>Le nuage des individus ne présente pas de forme particulière (triangle, fer à cheval…), les points semblent répartis dans l’ensemble du plan (1,2).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/cloud_ind-1.png" width="700"></p>
<p>Toutefois, dans certains cas, des points peuvent se superposer et la structure du nuage des individus n’est qu’imparfaitement rendue par un nuage de points. Il est alors possible de compléter le premier graphique par une représentation de la densité de points dans le plan. La fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/ggcloud_indiv.html"><code>ggcloud_indiv()</code></a> permet de le faire à l’aide de contours (à la manière des courbes de niveau d’une carte topographique) ou de surfaces hexagonales (colorées avec un gradient de couleur en fonction du nombre de points situés dans l’hexagone).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span>, col <span class="op">=</span> <span class="st">"lightgray"</span>, density <span class="op">=</span> <span class="st">"contour"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/cloud_ind_contour-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span>, density <span class="op">=</span> <span class="st">"hex"</span>, hex.bin <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/cloud_ind_hex-1.png" width="700"></p>
<p>Quelle que soit la représentation de la densité utilisée, on observe que les points semblent être plus concentrés dans une zone située immédiatement à droite de l’axe vertical.<br></p>
<p>NB : <a href="https://nicolas-robette.github.io/GDAtools/reference/ggcloud_indiv.html"><code>ggcloud_indiv()</code></a> permet également d’afficher le <em>nom</em> des observations, lorsque cela présente un intérêt du point de vue de l’interprétation.<br><br></p>
</div>
<div class="section level4">
<h4 id="nuage-des-variables">Nuage des variables<a class="anchor" aria-label="anchor" href="#nuage-des-variables"></a>
</h4>
<p>Sur le nuage des variables :</p>
<ul>
<li><p>l’écoute de jazz et de musique classique et le goût des comédies musicales semblent s’opposer à l’écoute de rap et au goût pour les comédies sur l’axe 1 ;</p></li>
<li><p>le goût pour l’animation et la science-fiction à celui pour les films d’amour et les comédies musicales sur l’axe 2.</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mca</span>, shapes <span class="op">=</span> <span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/cloud_var-1.png" width="700"></p>
<p>De nombreuses options sont possibles, notamment :</p>
<ul>
<li><p>ajout de symboles (cercles, triangles, etc.) en plus des noms des modalités ;</p></li>
<li><p>sélection ou mise en valeur des modalités les plus importantes selon différents critères (contribution, qualité de représentation, typicalité, etc.) ;</p></li>
<li><p>utilisation de la taille, de l’italique, du gras et du soulignement pour identifier les modalités les plus importantes.</p></li>
</ul>
<p> </p>
<p>On représente traditionnellement les résultats dans un plan, c’est-à-dire en deux dimensions (ici les dimensions 1 et 2). Mais il est parfois plus simple de concentrer l’interprétation sur un seul axe à la fois, ce qui est possible avec la fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/ggaxis_variables.html"><code>ggaxis_variables()</code></a> (paramétrée ici pour afficher les noms des modalités avec une taille proportionnelle à leur contribution à la construction de l’axe).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggaxis_variables.html">ggaxis_variables</a></span><span class="op">(</span><span class="va">mca</span>, axis <span class="op">=</span> <span class="fl">1</span>, prop <span class="op">=</span> <span class="st">"ctr"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/axis1-1.png" width="700"></p>
<p>Toutefois, l’interprétation du plan factoriel, pour être robuste, ne peut s’arrêter à un examen visuel du nuage des variables. Celui-ci doit être complété par l’analyse attentive d’indicateurs statistiques, en particulier des <strong>contributions</strong> des modalités à la construction des axes et de leur <strong>qualité de représentation</strong>.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="aides-à-linterprétation">Aides à l’interprétation<a class="anchor" aria-label="anchor" href="#aides-%C3%A0-linterpr%C3%A9tation"></a>
</h2>
<p>La plupart des aides à l’interprétation et autres informations utiles sont présentes dans l’objet créé par <a href="https://nicolas-robette.github.io/GDAtools/reference/speMCA.html"><code>speMCA()</code></a>. Le package propose plusieurs fonctions pour extraire et organiser ces informations.</p>
<ul>
<li><p><a href="https://nicolas-robette.github.io/GDAtools/reference/contrib.html"><code>contrib()</code></a> présente les contributions des variables et des modalités de ces variables à la construction de chacun des axes et à celle du nuage.</p></li>
<li><p><a href="https://nicolas-robette.github.io/GDAtools/reference/dimcontrib.html"><code>dimcontrib()</code></a> extrait les contributions des individus et des modalités de variables à la construction d’un axe en particulier.</p></li>
<li><p><a href="https://nicolas-robette.github.io/GDAtools/reference/dimdescr.html"><code>dimdescr()</code></a> identifie les variables et les modalités de variables les plus statistiquement associées aux différents axes. Les mesures d’association utilisées sont les <strong>rapports de corrélation</strong> (<strong>eta²</strong>) pour les variables et les <strong>coefficients de corrélation</strong> pour les modalités.</p></li>
<li><p><a href="https://nicolas-robette.github.io/GDAtools/reference/planecontrib.html"><code>planecontrib()</code></a> extrait les contributions des individus et des modalités de variables à la construction d’un <em>plan</em> en particulier.</p></li>
</ul>
<p>La fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/tabcontrib.html"><code>tabcontrib()</code></a> permet, pour un axe donné, de synthétiser les principales contributions (par défaut, seules les contributions supérieures à la moyenne sont présentées).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">mca</span>, dim <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="4%">
<col width="3%">
<col width="14%">
<col width="10%">
<col width="11%">
<col width="10%">
<col width="12%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Category</th>
<th align="right">Weight</th>
<th align="right">Quality of representation</th>
<th align="left">Contribution (left)</th>
<th align="left">Contribution (right)</th>
<th align="left">Total contribution</th>
<th align="left">Cumulated contribution</th>
<th align="left">Contribution of deviation</th>
<th align="left">Proportion to variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Classical</td>
<td align="left">Yes</td>
<td align="right">552</td>
<td align="right">0.478</td>
<td align="left">23.08</td>
<td align="left"></td>
<td align="left">31.88</td>
<td align="left">31.88</td>
<td align="left">31.88</td>
<td align="left">100</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">1443</td>
<td align="right">0.474</td>
<td align="left"></td>
<td align="left">8.8</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Jazz</td>
<td align="left">Yes</td>
<td align="right">364</td>
<td align="right">0.467</td>
<td align="left">25.49</td>
<td align="left"></td>
<td align="left">31.15</td>
<td align="left">63.04</td>
<td align="left">31.15</td>
<td align="left">100</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">1621</td>
<td align="right">0.448</td>
<td align="left"></td>
<td align="left">5.66</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Comedy</td>
<td align="left">Yes</td>
<td align="right">856</td>
<td align="right">0.253</td>
<td align="left"></td>
<td align="left">9.66</td>
<td align="left">16.88</td>
<td align="left">79.92</td>
<td align="left">16.88</td>
<td align="left">100</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">1141</td>
<td align="right">0.252</td>
<td align="left">7.22</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>Les variables d’écoute de musique classique et de jazz contribuent à elles seules pour plus de 60 % à la construction de l’axe 1. L’écoute de classique et de jazz s’oppose donc à leur non-écoute, et secondairement au goût pour les comédies.<br></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">mca</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="4%">
<col width="3%">
<col width="14%">
<col width="10%">
<col width="11%">
<col width="10%">
<col width="12%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Category</th>
<th align="right">Weight</th>
<th align="right">Quality of representation</th>
<th align="left">Contribution (left)</th>
<th align="left">Contribution (right)</th>
<th align="left">Total contribution</th>
<th align="left">Cumulated contribution</th>
<th align="left">Contribution of deviation</th>
<th align="left">Proportion to variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Rock</td>
<td align="left">Yes</td>
<td align="right">535</td>
<td align="right">0.229</td>
<td align="left"></td>
<td align="left">12.99</td>
<td align="left">17.77</td>
<td align="left">17.77</td>
<td align="left">17.77</td>
<td align="left">100</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">1455</td>
<td align="right">0.226</td>
<td align="left">4.78</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Love</td>
<td align="left">Yes</td>
<td align="right">225</td>
<td align="right">0.250</td>
<td align="left">17.24</td>
<td align="left"></td>
<td align="left">17.24</td>
<td align="left">35</td>
<td align="left">17.24</td>
<td align="left">88.79</td>
</tr>
<tr class="even">
<td align="left">FrenchPop</td>
<td align="left">No</td>
<td align="right">741</td>
<td align="right">0.199</td>
<td align="left"></td>
<td align="left">9.69</td>
<td align="left">15.39</td>
<td align="left">50.39</td>
<td align="left">15.39</td>
<td align="left">100</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Yes</td>
<td align="right">1249</td>
<td align="right">0.196</td>
<td align="left">5.69</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Musical</td>
<td align="left">Yes</td>
<td align="right">66</td>
<td align="right">0.191</td>
<td align="left">14.33</td>
<td align="left"></td>
<td align="left">14.33</td>
<td align="left">64.72</td>
<td align="left">14.33</td>
<td align="left">96.61</td>
</tr>
<tr class="odd">
<td align="left">SciFi</td>
<td align="left">Yes</td>
<td align="right">143</td>
<td align="right">0.160</td>
<td align="left"></td>
<td align="left">11.49</td>
<td align="left">11.49</td>
<td align="left">76.21</td>
<td align="left">11.49</td>
<td align="left">92.72</td>
</tr>
<tr class="even">
<td align="left">Rap</td>
<td align="left">Yes</td>
<td align="right">261</td>
<td align="right">0.164</td>
<td align="left"></td>
<td align="left">11.05</td>
<td align="left">11.05</td>
<td align="left">87.27</td>
<td align="left">11.05</td>
<td align="left">86.56</td>
</tr>
</tbody>
</table>
<p>Sur l’axe 2, l’écoute de rock et de rap et le goût pour les films de science-fiction s’opposent au goût pour les films d’amour et les comédies musicale et à l’écoute de variété française.</p>
<p>Une manière de synthétiser les relations entre les variables actives et les axes factoriels est le graphique appelé “carré des liaisons”, proposé par Escofier et Pagès (2008). Il utilise les rapports de corrélation pour représenter ces liaisons.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggeta2_variables.html">ggeta2_variables</a></span><span class="op">(</span><span class="va">mca</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Carré des liaisons"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/eta2_plot-1.png" width="700"></p>
<p>On constate que l’écoute du jazz et de la musique classique est fortement corrélée avec l’axe 1 et pas du tout avec l’axe 2, et que les variables actives les plus corrélées avec l’axe 2 ne le sont que modérément.</p>
<hr>
</div>
<div class="section level2">
<h2 id="les-facteurs-structurants">Les facteurs structurants<a class="anchor" aria-label="anchor" href="#les-facteurs-structurants"></a>
</h2>
<div class="section level4">
<h4 id="les-variables-supplémentaires">Les variables supplémentaires<a class="anchor" aria-label="anchor" href="#les-variables-suppl%C3%A9mentaires"></a>
</h4>
<p>On peut aller plus loin en étudiant la relation entre l’espace factoriel et les variables supplémentaires, en l’occurrence le sexe, l’âge et le niveau d’éducation. Une première étape consiste à projeter les variables supplémentaires sur le nuage des variables.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vcloud</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mca</span>, shapes<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggadd_supvars.html">ggadd_supvars</a></span><span class="op">(</span><span class="va">vcloud</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/cloud_varsup-1.png" width="700"></p>
<p>Il est possible de paramétrer séparément l’affichage de chacune des variables supplémentaires avec la fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/ggadd_supvar.html"><code>ggadd_supvar()</code></a> (sans “s”). Avec toutefois plusieurs contreparties : plus de lignes de code et risque de superposition des noms des modalités.</p>
<p>Le niveau d’éducation semble avant tout associé à l’axe 1, les plus diplômés étant du côté de l’écoute de jazz et de classique. Le sexe ne semble lié qu’à l’axe 2, avec les femmes dans le bas du plan et les hommes en haut. Quant à l’âge, il est associé aux deux axes : les individus se déplacent du quadrant nord-est au quadrant sud-ouest à mesure que leur âge augmente.</p>
<p>On peut confirmer statistiquement ces premières observations en mesurant le degré d’association entre les variables supplémentaires et les axes à l’aide du <strong>rapport de corrélation</strong> (<strong>eta²</strong>).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dimeta2.html">dimeta2</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>       dim.1 dim.2
Gender   0.0   6.0
Age      3.8  14.2
Educ     5.9   3.3</code></pre>
<p>Le niveau d’éducation est la variable supplémentaire la plus associée à l’axe 1 : il “explique” 5,9 % de la variance des coordonnées individuelles sur cet axe. L’âge est également associé au premier axe, mais de manière moins marquée, et le sexe pas du tout.</p>
<p>Sur l’axe 2, l’âge est la variable la plus structurante, devant le sexe et le niveau d’éducation. On voit en outre que l’âge est nettement plus lié à l’axe 2 qu’à l’axe 1.</p>
<p>Au niveau des modalités, on peut caractériser l’association d’une modalité de variable supplémentaire avec un axe à partir des <strong>coefficients de corrélation</strong>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">des</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimdescr.html">dimdescr</a></span><span class="op">(</span><span class="va">mca</span>, vars <span class="op">=</span> <span class="va">Taste</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">des</span><span class="op">$</span><span class="va">dim.1</span><span class="op">$</span><span class="va">categories</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">categories</th>
<th align="right">mean.y.in.xcat</th>
<th align="right">mean.y.global</th>
<th align="right">sd.y.in.xcat</th>
<th align="right">sd.y.global</th>
<th align="right">cor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age.15-24</td>
<td align="right">0.156</td>
<td align="right">0</td>
<td align="right">0.355</td>
<td align="right">0.369</td>
<td align="right">0.176</td>
</tr>
<tr class="even">
<td align="left">Educ.None</td>
<td align="right">0.094</td>
<td align="right">0</td>
<td align="right">0.324</td>
<td align="right">0.369</td>
<td align="right">0.145</td>
</tr>
<tr class="odd">
<td align="left">Educ.Low</td>
<td align="right">0.052</td>
<td align="right">0</td>
<td align="right">0.355</td>
<td align="right">0.369</td>
<td align="right">0.100</td>
</tr>
<tr class="even">
<td align="left">Age.25-49</td>
<td align="right">0.006</td>
<td align="right">0</td>
<td align="right">0.358</td>
<td align="right">0.369</td>
<td align="right">0.015</td>
</tr>
<tr class="odd">
<td align="left">Gender.Women</td>
<td align="right">0.004</td>
<td align="right">0</td>
<td align="right">0.370</td>
<td align="right">0.369</td>
<td align="right">0.012</td>
</tr>
<tr class="even">
<td align="left">Gender.Men</td>
<td align="right">-0.005</td>
<td align="right">0</td>
<td align="right">0.368</td>
<td align="right">0.369</td>
<td align="right">-0.012</td>
</tr>
<tr class="odd">
<td align="left">Educ.Medium</td>
<td align="right">-0.040</td>
<td align="right">0</td>
<td align="right">0.376</td>
<td align="right">0.369</td>
<td align="right">-0.051</td>
</tr>
<tr class="even">
<td align="left">Age.50+</td>
<td align="right">-0.061</td>
<td align="right">0</td>
<td align="right">0.369</td>
<td align="right">0.369</td>
<td align="right">-0.142</td>
</tr>
<tr class="odd">
<td align="left">Educ.High</td>
<td align="right">-0.141</td>
<td align="right">0</td>
<td align="right">0.382</td>
<td align="right">0.369</td>
<td align="right">-0.213</td>
</tr>
</tbody>
</table>
<p>Sur l’axe 1, les non et peu diplômés et les 15-24 ans s’opposent aux plus diplômés et aux 50 ans et plus. Les autres modalités apparaissent peu liées à l’axe (leurs coefficients de corrélation, dans la dernière colonne du tableau, sont proches de 0).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">des</span><span class="op">$</span><span class="va">dim.2</span><span class="op">$</span><span class="va">categories</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">categories</th>
<th align="right">mean.y.in.xcat</th>
<th align="right">mean.y.global</th>
<th align="right">sd.y.in.xcat</th>
<th align="right">sd.y.global</th>
<th align="right">cor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age.15-24</td>
<td align="right">0.236</td>
<td align="right">0</td>
<td align="right">0.320</td>
<td align="right">0.342</td>
<td align="right">0.288</td>
</tr>
<tr class="even">
<td align="left">Gender.Men</td>
<td align="right">0.088</td>
<td align="right">0</td>
<td align="right">0.302</td>
<td align="right">0.342</td>
<td align="right">0.245</td>
</tr>
<tr class="odd">
<td align="left">Age.25-49</td>
<td align="right">0.049</td>
<td align="right">0</td>
<td align="right">0.333</td>
<td align="right">0.342</td>
<td align="right">0.123</td>
</tr>
<tr class="even">
<td align="left">Educ.High</td>
<td align="right">0.076</td>
<td align="right">0</td>
<td align="right">0.327</td>
<td align="right">0.342</td>
<td align="right">0.123</td>
</tr>
<tr class="odd">
<td align="left">Educ.Low</td>
<td align="right">0.016</td>
<td align="right">0</td>
<td align="right">0.341</td>
<td align="right">0.342</td>
<td align="right">0.034</td>
</tr>
<tr class="even">
<td align="left">Educ.Medium</td>
<td align="right">0.007</td>
<td align="right">0</td>
<td align="right">0.335</td>
<td align="right">0.342</td>
<td align="right">0.009</td>
</tr>
<tr class="odd">
<td align="left">Educ.None</td>
<td align="right">-0.100</td>
<td align="right">0</td>
<td align="right">0.341</td>
<td align="right">0.342</td>
<td align="right">-0.167</td>
</tr>
<tr class="even">
<td align="left">Gender.Women</td>
<td align="right">-0.081</td>
<td align="right">0</td>
<td align="right">0.357</td>
<td align="right">0.342</td>
<td align="right">-0.245</td>
</tr>
<tr class="odd">
<td align="left">Age.50+</td>
<td align="right">-0.131</td>
<td align="right">0</td>
<td align="right">0.299</td>
<td align="right">0.342</td>
<td align="right">-0.330</td>
</tr>
</tbody>
</table>
<p>Sur l’axe 2, les hommes, les moins de 50 ans et les plus diplômés s’opposent aux femmes, aux plus de 50 ans et aux sans diplôme.</p>
</div>
<div class="section level4">
<h4 id="analyse-dune-variable-supplémentaire">Analyse d’une variable supplémentaire<a class="anchor" aria-label="anchor" href="#analyse-dune-variable-suppl%C3%A9mentaire"></a>
</h4>
<p>Poursuivons l’analyse en nous concentrant sur <em>une</em> variable supplémentaire, le niveau d’éducation. La fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/supvar.html"><code>supvar()</code></a> fournit :</p>
<ul>
<li><p>les coordonnées des modalités sur les axes,</p></li>
<li><p>leurs <em>cosinus²</em> (qui donnent la qualité de représentation d’une modalité sur un axe),</p></li>
<li><p>leurs dispersions (variances) sur les axes,</p></li>
<li><p>les rapports de corrélation (<em>eta²</em>) entre la variable et les axes,</p></li>
<li><p>les <em>tests de typicalité</em> (sur lesquels nous reviendrons dans la partie suivante),</p></li>
<li><p>les <em>coefficients de corrélation</em> entre les modalités et les axes.</p></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/supvar.html">supvar</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">)</span></span></code></pre></div>
<pre><code>$weight
  None    Low Medium   High 
   490    678    357    475 

$coord
           dim.1     dim.2     dim.3     dim.4     dim.5
None    0.254716 -0.293253 -0.191563  0.094510 -0.050520
Low     0.140147  0.046951  0.002259 -0.063613 -0.044181
Medium -0.109057  0.019669  0.054436  0.070183 -0.027962
High   -0.380835  0.220714  0.153475 -0.059443  0.136194

$cos2
          dim.1    dim.2    dim.3    dim.4    dim.5
None   0.021054 0.027906 0.011908 0.002899 0.000828
Low    0.010073 0.001131 0.000003 0.002075 0.001001
Medium 0.002584 0.000084 0.000644 0.001070 0.000170
High   0.045175 0.015173 0.007337 0.001101 0.005777

$var
           dim.1    dim.2    dim.3    dim.4    dim.5
None    0.104915 0.116125 0.115232 0.103800 0.086031
Low     0.125921 0.116092 0.109029 0.087945 0.087735
Medium  0.141298 0.112505 0.097031 0.102449 0.094541
High    0.145983 0.107170 0.091066 0.106049 0.113352
within  0.128284 0.113341 0.104141 0.098718 0.094616
between 0.008061 0.003923 0.001598 0.000524 0.000555
total   0.136345 0.117264 0.105739 0.099242 0.095172
eta2    0.059123 0.033455 0.015115 0.005279 0.005832

$typic
           dim.1     dim.2     dim.3     dim.4     dim.5
None    6.487410 -7.468929 -4.878958  2.407110 -1.286704
Low     4.487336  1.503312  0.072336 -2.036827 -1.414633
Medium -2.272883  0.409932  1.134503  1.462690 -0.582753
High   -9.502876  5.507427  3.829615 -1.483270  3.398406

$pval
          dim.1    dim.2    dim.3    dim.4    dim.5
None   0.000000 0.000000 0.000001 0.016079 0.198197
Low    0.000007 0.132758 0.942334 0.041667 0.157176
Medium 0.023033 0.681856 0.256584 0.143552 0.560059
High   0.000000 0.000000 0.000128 0.138003 0.000678

$cor
        dim.1  dim.2  dim.3  dim.4  dim.5
None    0.145 -0.167 -0.109  0.054 -0.029
Low     0.100  0.034  0.002 -0.046 -0.032
Medium -0.051  0.009  0.025  0.033 -0.013
High   -0.213  0.123  0.086 -0.033  0.076</code></pre>
<p>Graphiquement, on peut représenter le “sous-nuage” de chacune des modalités à l’aide d’une <strong>ellipse de concentration</strong>, qui est centrée sur le point moyen et englobe 86 % des individus ayant cette modalité.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">icloud</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcloud_indiv.html">ggcloud_indiv</a></span><span class="op">(</span><span class="va">mca</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggadd_kellipses.html">ggadd_kellipses</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/educ_ellipses-1.png" width="700"></p>
<p>Même si, on l’a vu, les modalités du niveau d’éducation s’ordonnent le long de l’axe 1, les sous-nuages se superposent très largement, car l’association entre la variable et l’axe est modérée.</p>
<p>Observons maintenant plus spécifiquement le sous-nuage des individus les plus diplômés (la 4ème modalité de la variable <code>Educ</code>).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggadd_kellipses.html">ggadd_kellipses</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, sel <span class="op">=</span> <span class="fl">4</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/educ_ellipse-1.png" width="700"></p>
<p>Une ellipse de concentration est utile car elle représente conjointement le point moyen de la modalité et la dispersion du sous-nuage sur les axes. Ici, on voit que bien que le point moyen des individus les plus diplômés soit situé dans le quadrant nord-ouest, une part non négligeable des points du sous-nuage se trouve à droite et/ou en bas du plan.</p>
<p>Les ellipses de concentration ne donnent en revanche qu’une représentation imparfaite de la répartition des points du sous-nuage, du fait de l’éventuelle superposition des points (de manière analogue à ce qu’on a vu pour le nuage des individus) et son centrage sur le point moyen. Il peut dès lors être intéressant de compléter une ellipse de concentration par une représentation de la densité des points du sous-nuage, sous forme de contours ou de surfaces.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggadd_density.html">ggadd_density</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, var <span class="op">=</span> <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, cat <span class="op">=</span> <span class="st">"High"</span>, density <span class="op">=</span> <span class="st">"contour"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/educ_contour-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggadd_density.html">ggadd_density</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, var <span class="op">=</span> <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, cat <span class="op">=</span> <span class="st">"High"</span>, density <span class="op">=</span> <span class="st">"area"</span>, ellipse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/educ_area-1.png" width="700"></p>
<p>On voit ici qu’il semble y avoir une concentration d’individus très diplômés immédiatement à droite de l’axe vertical, dans une zone qui correspond aussi à une concentration de points du nuage des individus (voir plus haut).</p>
<p>Un pas supplémentaire dans l’analyse consiste à neutraliser l’influence de la répartition des points du nuage des individus sur celle du sous-nuage, en se demandant dans quelles parties du plan les plus diplômés sont sur/sous-représentés. Dans le graphique suivant, on représente dans chaque tuile hexagonale la proportion d’individus très diplômés, centrée par rapport à la proportion d’individus très diplômés dans l’ensemble de l’échantillon. Autrement dit on représente la sur/sous-représentation d’individus très diplômés dans chaque portion du plan. Le graphique est rendu plus lisible par une procédure de lissage issue de l’analyse spatiale en géographie (<em>inverse distance weighting</em>).</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggsmoothed_supvar.html">ggsmoothed_supvar</a></span><span class="op">(</span><span class="va">mca</span>, var <span class="op">=</span> <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, cat <span class="op">=</span> <span class="st">"High"</span>, center <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/educ_smoothed-1.png" width="700"></p>
<p>Les individus les plus diplômés sont sur-représentés dans l’ensemble du quadrant nord-ouest, mais également parmi les plus à l’ouest du quadrant sud-ouest.</p>
</div>
<div class="section level4">
<h4 id="interaction-entre-deux-variables-supplémentaires">Interaction entre deux variables supplémentaires<a class="anchor" aria-label="anchor" href="#interaction-entre-deux-variables-suppl%C3%A9mentaires"></a>
</h4>
<p>On peut également étudier les interactions entre plusieurs variables supplémentaires, par exemple ici entre le sexe et l’âge.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggadd_interaction.html">ggadd_interaction</a></span><span class="op">(</span><span class="va">vcloud</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Gender</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Age</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/interaction-1.png" width="700"></p>
<p>Le sexe et l’âge semblent peu interagir dans le plan 1-2. On remarque toutefois que, sur l’axe 1, les écarts entre les plus jeunes et les plus âgés sont plus importants chez les femmes que chez les hommes et que, sur l’axe 2, les jeunes se différencient plus selon le sexe que les plus âgés.</p>
<p>NB : Les analyses effectuées ici sur des variables supplémentaires sont réalisables de manière analogue pour des <em>individus</em> supplémentaires, à l’aide des fonctions <a href="https://nicolas-robette.github.io/GDAtools/reference/supind.html"><code>supind()</code></a> et <a href="https://nicolas-robette.github.io/GDAtools/reference/ggadd_supind.html"><code>ggadd_supind()</code></a>. Cela présente un intérêt lorsque certains individus ont été écartés de l’ACM parce que trop atypiques ou que certaines informations manquaient, par exemple.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="analyse-inductive">Analyse inductive<a class="anchor" aria-label="anchor" href="#analyse-inductive"></a>
</h2>
<p>Si on souhaite évaluer la généralisabilité des résultats, on peut compléter les analyses descriptives qui précèdent par des procédures d’inférence statistique qui empruntent à l’analyse inductive des données et aux approches combinatoires (pour cette partie plus encore que pour les autres, on renvoie à Le Roux et Rouanet, 2004 &amp; 2010).</p>
<p>Le problème de la typicalité consiste à se demander si un groupe d’individus peut être assimilé à la population de référence ou s’il est atypique. Un <strong>test de typicalité</strong> calcule une <em>p-value combinatoire</em>, qui définit le “degré de typicalité” du point moyen du groupe d’individus. Une p-value faible est considérée comme statistiquement significative au sens combinatoire et traduit une différence qui n’est probablement pas due au hasard.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dimtypicality.html">dimtypicality</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>,<span class="st">"Age"</span>,<span class="st">"Educ"</span><span class="op">)</span><span class="op">]</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>$dim.1
             weight test.stat p.value
Age.15-24       297  7.890052 0.00000
Educ.None       490  6.487410 0.00000
Educ.Low        678  4.487336 0.00001
Age.25-49       849  0.669142 0.50340
Gender.Women   1042  0.543265 0.58695
Gender.Men      958 -0.543265 0.58695
Educ.Medium     357 -2.272883 0.02303
Age.50+         854 -6.340738 0.00000
Educ.High       475 -9.502876 0.00000

$dim.2
             weight  test.stat p.value
Age.15-24       297  12.875430 0.00000
Gender.Men      958  10.972527 0.00000
Age.25-49       849   5.520379 0.00000
Educ.High       475   5.507427 0.00000
Educ.Low        678   1.503312 0.13276
Educ.Medium     357   0.409932 0.68186
Educ.None       490  -7.468929 0.00000
Gender.Women   1042 -10.972527 0.00000
Age.50+         854 -14.772247 0.00000</code></pre>
<p>A un seuil de 5 %, les points moyens des femmes, hommes et âges intermédiaires ne sont pas significativement différents de celui de l’ensemble de la population sur l’axe 1 (autrement dit de 0). Sur l’axe 2, ce sont les points moyens des niveaux d’éducation faibles et moyens qui ne s’écartent pas significativement de l’origine.</p>
<p>On peut étudier les résultats des tests de typicalité d’une variable supplémentaire en particulier à partir de la fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/supvar.html"><code>supvar()</code></a>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vseduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/supvar.html">supvar</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">)</span></span>
<span><span class="va">vseduc</span><span class="op">$</span><span class="va">pval</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>          dim.1    dim.2
None   0.000000 0.000000
Low    0.000007 0.132758
Medium 0.023033 0.681856
High   0.000000 0.000000</code></pre>
<p>On voit que, sur l’axe 1, toutes les modalités de niveau d’éducation sont significativement différentes de 0 à un seuil de 5 %, elles sont atypiques du nuage de l’ensemble des individus, mais que ce n’est pas le cas des modalités “Low” et “Medium” sur l’axe 2.</p>
<p> </p>
<p>Les <strong>ellipses de confiance</strong> répondent à la même logique que les tests de typicalité. Avec un seuil de significativité conventionnel de 5 %, l’ellipse de confiance est une zone de confiance à 95 % représentant, pour une modalité, l’ensemble des points moyens possibles qui ne sont pas significativement différents du point moyen observé.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># p &lt;- ggcloud_indiv(mca, col='lightgrey')</span></span>
<span><span class="fu"><a href="../reference/ggadd_ellipses.html">ggadd_ellipses</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span>, level <span class="op">=</span> <span class="fl">0.05</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/educ_conc_ellipses-1.png" width="700"></p>
<p>On retrouve ici graphiquement les résultats obtenus avec les tests de typicalité.</p>
<p> </p>
<p>Un <strong>test d’homogénéité</strong> est une procédure combinatoire qui vise à comparer plusieurs groupes d’individus. La question que l’on se pose est de savoir si, sur un axe donné, les positions de deux groupes d’individus sont significativement distinctes (i.e. si les p-values sont toutes très proches de 0). Les groupes correspondent aux différentes modalités d’une variable.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ht</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/homog.test.html">homog.test</a></span><span class="op">(</span><span class="va">mca</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ht</span><span class="op">$</span><span class="va">dim.1</span><span class="op">$</span><span class="va">p.values</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>       None Low Medium High
None      1   0      0    0
Low       0   1      0    0
Medium    0   0      1    0
High      0   0      0    1</code></pre>
<p>Sur l’axe 1, les points moyens des modalités de niveau d’éducation sont toutes significativement distinctes les unes des autres.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ht</span><span class="op">$</span><span class="va">dim.2</span><span class="op">$</span><span class="va">p.values</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>       None   Low Medium High
None      1 0.000  0.000    0
Low       0 1.000  0.223    0
Medium    0 0.223  1.000    0
High      0 0.000  0.000    1</code></pre>
<p>Ce n’est pas le cas sur l’axe 2, où les modalités “Low” et “Medium” ne se distinguent pas significativement (p-value = 0,22).</p>
<hr>
</div>
<div class="section level2">
<h2 id="validation-interne">Validation interne<a class="anchor" aria-label="anchor" href="#validation-interne"></a>
</h2>
<p>Le manque de robustesse des ACM, ou l’absence de moyens de mesurer cette robustesse, est parfois présenté comme l’une des faiblesses de l’analyse géométrique des données. Ces critiques ne sont guère pertinentes, notamment du fait qu’il existe des techniques de “validation interne” des résultats des ACM. Ludovic Lebart (2006 ; 2007) a ainsi proposé de s’appuyer sur le <em>bootstrap</em>, i.e. le rééchantillonnage par tirage aléatoire avec remise. Cette approche présente l’avantage d’être non-paramétrique, i.e. de ne reposer sur aucune des hypothèses probabilistes de l’inférence fréquentiste.</p>
<p>Lebart proposer plusieurs méthodes. Le <strong>bootstrap total</strong> utilise de nouvelles ACM calculées à partir de réplications bootstrap des données initiales.</p>
<ul>
<li><p>Dans le bootstrap total de <em>type 1</em>, le signe des coordonnées est corrigé si nécessaire (la direction des axes d’une ACM étant arbitraire).</p></li>
<li><p>Dans le <em>type 2</em>, l’ordre des axes et le signe des coordonnées sont corrigés si nécessaire.</p></li>
<li><p>Dans le <em>type 3</em>, une rotation procustéenne est utilisée pour trouver la meilleure superposition entre les axes initiaux et les axes répliqués.</p></li>
</ul>
<p>Le <strong>bootstrap partiel</strong>, quant à lui, ne calcule pas de nouvelle ACM : il projette des réplications bootstrap des données initiales comme éléments supplémentaires de l’ACM. Il donne une vision plus optimiste (ou moins exigeante) de la stabilité des résultats que le bootstrap total.</p>
<p>Ci-dessous, les résultats d’un bootstrap partiel (avec 30 réplications, nombre considéré comme généralement suffisant par Lebart) sont représentés à l’aide d’ellipses de confiance. On constate que si les points des réplications bootstrap de quelques modalités sont relativement dispersés, ce n’est le cas que de modalités éloignées de l’origine du plan et ne modifie en rien l’interprétation des résultats de l’ACM : ceux-ci sont tout à fait robustes.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggbootvalid_variables.html">ggbootvalid_variables</a></span><span class="op">(</span><span class="va">mca</span>, type <span class="op">=</span> <span class="st">"partial"</span>, K <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/bootstrap-1.png" width="700"></p>
<p>Il est possible de mener le même type d’analyses pour des variables supplémentaires avec la fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/ggbootvalid_supvars.html"><code>ggbootvalid_supvars()</code></a>, et d’obtenir les résultats des calculs de réplications bootstrap (sans représentation graphique) avec les fonctions <a href="https://nicolas-robette.github.io/GDAtools/reference/bootvalid_variables.html"><code>bootvalid_variables()</code></a> et <a href="https://nicolas-robette.github.io/GDAtools/reference/bootvalid_supvars.html"><code>bootvalid_supvars()</code></a>.</p>
<hr>
</div>
<div class="section level2">
<h2 id="acm-et-classification">ACM et classification<a class="anchor" aria-label="anchor" href="#acm-et-classification"></a>
</h2>
<p>L’ACM et les techniques de classification automatique sont souvent utilisées conjointement. Par exemple, après avoir représenté les données par des plans factoriels, on peut souhaiter obtenir un résumé sous la forme d’une typologie, autrement dit regrouper les individus qui se ressemblent. On peut pour cela s’appuyer sur les données d’origine ou sur les coordonnées des individus dans le nuage de l’ACM.</p>
<p>On réalise ici une <strong>Classification Ascendante Hiérarchique</strong> (CAH) à partir des coordonnées des individus dans le plan factoriel (1,2), puis une partition en 3 classe.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">mca</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">hca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"ward.D2"</span><span class="op">)</span></span>
<span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">hca</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>On peut ensuite utiliser la partition ainsi créée pour de nouvelles analyses, par exemple en la croisant avec des variables supplémentaires, ou plus simplement représenter les sous-nuages d’individus correspondant aux classes de la typologie, à l’aide d’<strong>enveloppes convexes</strong>. Une enveloppe convexe est le polygone convexe le plus petit parmi ceux qui contiennent un ensemble de points. Dans le contexte de l’ACM, les enveloppes convexes sont une représentation graphique intéressante surtout si les sous-nuages représentés sont relativement peu superposés, comme c’est le cas ici.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggadd_chulls.html">ggadd_chulls</a></span><span class="op">(</span><span class="va">icloud</span>, <span class="va">mca</span>, <span class="va">cluster</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/chull-1.png" width="700"></p>
<p>Quelques remarques :</p>
<ul>
<li><p>La fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/quadrant.html"><code>quadrant()</code></a> crée également une typologie des individus, de manière plus simple : chaque individu est classé selon la partie du plan (le “quadrant”) où il se situe (nord-ouest, nord-est, sud-est, sud-ouest).</p></li>
<li><p>Il existe de nombreuses mesures de distances / ressemblances. Dans l’exemple ci-dessus, on a utilisé la distance euclidienne entre les coordonnées des individus. Si on réalise une classification automatique <em>à partir des variables d’origine</em> de l’ACM, il est cohérent d’employer la distance du chi-2, celle qui est utilisée par les analyses des correspondances, ce qui est possible avec la fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/dist.chi2.html"><code>dist.chi2()</code></a>.</p></li>
<li><p>La fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/ahc.plots.html"><code>ahc.plots()</code></a> propose quelques représentations graphiques qui donnent des indications pour le choix du nombre de classes à partir des résultats d’une CAH.</p></li>
<li><p>Si la CAH est la technique de classification automatique la plus répandue en analyse géométrique des données, il en existe de nombreuses autres (voir par exemple le package <a href="https://cran.r-project.org/package=cluster" class="external-link"><code>cluster</code></a>).</p></li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="variantes-de-lacm">Variantes de l’ACM<a class="anchor" aria-label="anchor" href="#variantes-de-lacm"></a>
</h2>
<div class="section level4">
<h4 id="class-specific-analysis">Class Specific Analysis<a class="anchor" aria-label="anchor" href="#class-specific-analysis"></a>
</h4>
<p>La <strong>Class Specific Analysis</strong> (CSA) est un prolongement de l’ACM qui permet d’étudier un sous-nuage d’individus en prenant conjointement en compte la distribution des variables dans le sous-nuage <em>et</em> dans l’ensemble du nuage. Il s’agit donc de tenir compte du fait que la structure du sous-nuage n’existe pas <em>in abstracto</em> mais en relation avec le nuage dans lequel il s’inscrit.</p>
<p>On illustre ici la CSA à partir du sous-nuage des individus les plus diplômés.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/csMCA.html">csMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, <span class="va">Taste</span><span class="op">$</span><span class="va">Educ</span><span class="op">==</span><span class="st">"High"</span>, excl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">18</span>,<span class="fl">21</span>,<span class="fl">24</span>,<span class="fl">27</span>,<span class="fl">30</span>,<span class="fl">33</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">csa</span>, shapes <span class="op">=</span> <span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/csa_cloud_var-1.png" width="700"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">csa</span>, dim <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="4%">
<col width="3%">
<col width="14%">
<col width="10%">
<col width="11%">
<col width="10%">
<col width="12%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Category</th>
<th align="right">Weight</th>
<th align="right">Quality of representation</th>
<th align="left">Contribution (left)</th>
<th align="left">Contribution (right)</th>
<th align="left">Total contribution</th>
<th align="left">Cumulated contribution</th>
<th align="left">Contribution of deviation</th>
<th align="left">Proportion to variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Jazz</td>
<td align="left">Yes</td>
<td align="right">145</td>
<td align="right">0.629</td>
<td align="left">41.85</td>
<td align="left"></td>
<td align="left">51.08</td>
<td align="left">51.08</td>
<td align="left">17.25</td>
<td align="left">33.76</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">326</td>
<td align="right">0.608</td>
<td align="left"></td>
<td align="left">9.23</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Classical</td>
<td align="left">Yes</td>
<td align="right">183</td>
<td align="right">0.363</td>
<td align="left">17.79</td>
<td align="left"></td>
<td align="left">24.55</td>
<td align="left">75.63</td>
<td align="left">6.9</td>
<td align="left">28.1</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">No</td>
<td align="right">290</td>
<td align="right">0.359</td>
<td align="left"></td>
<td align="left">6.76</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Animation</td>
<td align="left">Yes</td>
<td align="right">34</td>
<td align="right">0.149</td>
<td align="left"></td>
<td align="left">12.43</td>
<td align="left">12.43</td>
<td align="left">88.06</td>
<td align="left">4.64</td>
<td align="left">35.66</td>
</tr>
</tbody>
</table>
<p>On voit que, comme dans l’ACM, l’écoute de jazz et de musique classique structurent l’axe 1, mais cette fois beaucoup plus fortement puisque ces deux variables contribuent à elles seules pour 75 % à la construction de l’axe.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tabcontrib.html">tabcontrib</a></span><span class="op">(</span><span class="va">csa</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="4%">
<col width="3%">
<col width="14%">
<col width="10%">
<col width="11%">
<col width="10%">
<col width="12%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Category</th>
<th align="right">Weight</th>
<th align="right">Quality of representation</th>
<th align="left">Contribution (left)</th>
<th align="left">Contribution (right)</th>
<th align="left">Total contribution</th>
<th align="left">Cumulated contribution</th>
<th align="left">Contribution of deviation</th>
<th align="left">Proportion to variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Animation</td>
<td align="left">Yes</td>
<td align="right">34</td>
<td align="right">0.651</td>
<td align="left">59.05</td>
<td align="left"></td>
<td align="left">59.05</td>
<td align="left">59.05</td>
<td align="left">22.06</td>
<td align="left">35.66</td>
</tr>
<tr class="even">
<td align="left">SciFi</td>
<td align="left">Yes</td>
<td align="right">38</td>
<td align="right">0.149</td>
<td align="left">9.51</td>
<td align="left"></td>
<td align="left">9.51</td>
<td align="left">68.55</td>
<td align="left">2.53</td>
<td align="left">24.72</td>
</tr>
<tr class="odd">
<td align="left">Rock</td>
<td align="left">Yes</td>
<td align="right">203</td>
<td align="right">0.118</td>
<td align="left">6.71</td>
<td align="left"></td>
<td align="left">6.71</td>
<td align="left">75.26</td>
<td align="left">2.55</td>
<td align="left">27.32</td>
</tr>
<tr class="even">
<td align="left">Jazz</td>
<td align="left">Yes</td>
<td align="right">145</td>
<td align="right">0.075</td>
<td align="left">5.43</td>
<td align="left"></td>
<td align="left">5.43</td>
<td align="left">80.69</td>
<td align="left">2.16</td>
<td align="left">32.22</td>
</tr>
</tbody>
</table>
<p>C’est avant tout le goût pour les films d’animation qui contribue à la construction de l’axe 2.</p>
<p>En somme, le sous-nuage des variables des plus diplômés présente des points communs avec celui de l’ensemble de la population, mais aussi quelques spécificités très marquées.</p>
<p>La ressemblance entre l’ACM portant sur l’ensemble des individus et la CSA sur les individus les plus diplômés peut être mesurée en étudiant les angles entre les axes des deux analyses, avec la fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/angles.csa.html"><code>angles.csa()</code></a>.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/angles.csa.html">angles.csa</a></span><span class="op">(</span><span class="va">csa</span>, <span class="va">mca</span><span class="op">)</span></span></code></pre></div>
<pre><code>$cosines
         mca.dim1 mca.dim2 mca.dim3 mca.dim4 mca.dim5 mca.dim1&amp;2 mca.dim1&amp;3
csa.dim1    0.772    0.157   -0.051    0.415    0.486      0.787      0.773
csa.dim2    0.553   -0.481   -0.063   -0.511   -0.535      0.733      0.557
csa.dim3   -0.017   -0.680   -0.059    0.010    0.480      0.680      0.061
csa.dim4    0.223    0.182    0.385   -0.482    0.179      0.287      0.445
csa.dim5   -0.181   -0.296   -0.298   -0.350    0.154      0.347      0.348
         mca.dim1&amp;4 mca.dim1&amp;5 mca.dim2&amp;3 mca.dim2&amp;4 mca.dim2&amp;5 mca.dim3&amp;4
csa.dim1      0.876      0.912      0.165      0.444      0.511      0.418
csa.dim2      0.753      0.770      0.485      0.702      0.719      0.515
csa.dim3      0.020      0.480      0.682      0.680      0.832      0.059
csa.dim4      0.531      0.286      0.426      0.515      0.256      0.617
csa.dim5      0.394      0.238      0.420      0.458      0.334      0.459
         mca.dim3&amp;5 mca.dim4&amp;5
csa.dim1      0.489      0.639
csa.dim2      0.539      0.740
csa.dim3      0.483      0.480
csa.dim4      0.425      0.515
csa.dim5      0.335      0.382

$angles
         mca.dim1 mca.dim2 mca.dim3 mca.dim4 mca.dim5 mca.dim1&amp;2 mca.dim1&amp;3
csa.dim1     39.5     81.0     87.1     65.5     60.9       38.1       39.4
csa.dim2     56.4     61.3     86.4     59.3     57.7       42.9       56.2
csa.dim3     89.0     47.2     86.6     89.4     61.3       47.2       86.5
csa.dim4     77.1     79.5     67.3     61.2     79.7       73.3       63.6
csa.dim5     79.6     72.8     72.7     69.5     81.2       69.7       69.6
         mca.dim1&amp;4 mca.dim1&amp;5 mca.dim2&amp;3 mca.dim2&amp;4 mca.dim2&amp;5 mca.dim3&amp;4
csa.dim1       28.8       24.2       80.5       63.7       59.3       65.3
csa.dim2       41.1       39.7       61.0       45.4       44.0       59.0
csa.dim3       88.9       61.3       47.0       47.2       33.7       86.6
csa.dim4       57.9       73.4       64.8       59.0       75.2       51.9
csa.dim5       66.8       76.3       65.2       62.7       70.5       62.7
         mca.dim3&amp;5 mca.dim4&amp;5
csa.dim1       60.7       50.2
csa.dim2       57.4       42.3
csa.dim3       61.1       61.3
csa.dim4       64.9       59.0
csa.dim5       70.4       67.5</code></pre>
<p>On voit que la première dimension de la CSA est nettement corrélée à la première dimension de l’ACM (et très peu à la dimension 2), mais que la deuxième dimension de la CSA se distingue assez nettement des deux premières dimensions de l’ACM.</p>
<p>On n’ira pas plus loin ici mais précisons que toutes les techniques de visualisation et d’interprétation décrites précédemment peuvent s’appliquer aux résultats d’une CSA.</p>
</div>
<div class="section level4">
<h4 id="analyses-discriminantes">Analyses discriminantes<a class="anchor" aria-label="anchor" href="#analyses-discriminantes"></a>
</h4>
<p>L’approche par variables instrumentales constitue une forme de rapprochement entre l’analyse géométrique des données et les méthodes de régression. En pratique, il s’agit de construire un espace factoriel, à partir d’un premier groupe de variables actives, de manière à ce que cet espace “explique” au mieux un second ensemble de variables, dites <strong>variables instrumentales</strong>. On parle ici d’expliquer dans un sens analogue aux analyses de variance (anova) ou de régression, dans lesquelles une variable explicative “explique” une variable à expliquer, i.e. rend compte le mieux possible de sa variance.</p>
<p>Dans le cas général, il y a plusieurs variables instrumentales, qui peuvent être catégorielles et/ou numériques. Lorsque les variables actives sont toutes numériques, on parle d’Analyse en Composantes Principales sur Variables Instrumentales (fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/PCAiv.html"><code>PCAiv()</code></a>), et lorsque les variables actives sont toutes catégorielles, d’Analyse des Correspondances sur Variables Instrumentales (fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/MCAiv.html"><code>MCAiv()</code></a>).</p>
<p>Si la variable instrumentale est unique et catégorielle, on peut dire qu’elle partitionne les individus en groupes ou “classes”. Il s’agit donc de faire une <strong>analyse inter-classes</strong>, en construisant un espace factoriel qui rend compte des différences entre classes (fonctions <a href="https://nicolas-robette.github.io/GDAtools/reference/bcPCA.html"><code>bcPCA()</code></a> pour les cas où les variables actives sont continues et <a href="https://nicolas-robette.github.io/GDAtools/reference/bcMCA.html"><code>bcMCA()</code></a> pour ceux où elles sont catégorielles). On parle aussi parfois d’<strong>analyse discriminante barycentrique</strong> ou d’<em>analyse des correspondances discriminantes</em>. Si les variables actives sont continues, une variante est l’<strong>analyse factorielle discriminante</strong> (AFD), dite aussi <em>analyse discriminante descriptive</em> (fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/DA.html"><code>DA()</code></a>), qui est équivalente à l’<em>analyse discriminante linéaire</em> dans la littérature anglo-saxonne. Lorsque les variables actives sont catégorielles, une adaptation de l’AFD a été proposée par Gilbert Saporta (1977) sous le nom de <strong>Disqual</strong> (fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/DAQ.html"><code>DAQ()</code></a>).</p>
<p>En guise d’exemple, on applique une analyse discriminante barycentrique pour construire l’espace factoriel des différences de goûts entre les individus des différentes catégories d’âge.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">between</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bcMCA.html">bcMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, class <span class="op">=</span> <span class="va">Taste</span><span class="op">$</span><span class="va">Age</span>, excl <span class="op">=</span> <span class="va">junk</span><span class="op">)</span></span>
<span><span class="fu">factoextra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_ca.html" class="external-link">fviz_ca</a></span><span class="op">(</span><span class="va">between</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>, invisible <span class="op">=</span> <span class="st">"row.sup"</span>, </span>
<span>                    col.col <span class="op">=</span> <span class="st">"dodgerblue3"</span>, col.row <span class="op">=</span> <span class="st">"tomato2"</span>, title <span class="op">=</span> <span class="st">"Between-class analysis"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/between-1.png" width="700"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">between</span><span class="op">$</span><span class="va">ratio</span></span></code></pre></div>
<pre><code>[1] 0.04077871</code></pre>
<p>Le premier axe, ou “facteur discriminant”, ordonne les catégories d’âge et oppose notamment l’écoute de rap et de rock et le goût pour la science-fiction, du côté des jeunes, à l’écoute de musique classique et au goût pour les comédies musicales, du côté des plus de 50 ans. Mais beaucoup de modalités de goûts sont proches du centre de l’axe 1 et sont donc peu différenciées selon l’âge. Les différences d’âge ne rendent d’ailleurs compte que de 4% de l’inertie totale du nuage.</p>
</div>
<div class="section level4">
<h4 id="analyses-conditionnelles">Analyses conditionnelles<a class="anchor" aria-label="anchor" href="#analyses-conditionnelles"></a>
</h4>
<p>Les <em>analyses conditionnelles</em> constituent une autre tentative d’intégration de l’analyse géométrique des données et de la régression. Leur principe consiste à contraindre les axes de l’ACM à être indépendants (i.e. orthogonaux) d’une ou plusieurs variables supplémentaires, c’est-à-dire à construire une ACM “toute chose (de ces variables supplémentaires) égale par ailleurs” (Bry et al, 2016). La comparaison des résultats de l’ACM originelle et de ceux de l’ACM conditionnelle est un moyen d’étudier les effets de structure.</p>
<p>Dans le cas général, il y a plusieurs variables dont il faut “éliminer l’effet” et celles-ci sont parfois appelées <strong>variables instrumentales orthogonales</strong>. On réalisera donc une <em>Analyse en Composantes Principales sur Variables Instrumentales Orthogonales</em> si les variables actives sont toutes numériques (fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/PCAoiv.html"><code>PCAoiv()</code></a>) et une <em>Analyse des Correspondances sur Variables Instrumentales Orthogonales</em> si les variables actives sont toutes catégorielles (fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/MCAoiv.html"><code>MCAoiv()</code></a>).</p>
<p>Comme pour les analyses discriminantes (sous-partie précédente), si la variable instrumentale orthogonale est unique et catégorielle, elle partitionne les individus en “classes”. Mais on est cette fois dans le cadre d’une <strong>analyse intra-classes</strong> : il s’agit de construire l’espace factoriel rendant compte des structures communes aux différentes classes. Lorsque les variables actives sont catégorielles, on réalise une <strong>ACM conditionnelle</strong> (Escofier, 1990 et fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/wcMCA.html"><code>wcMCA()</code></a>), dont l’<strong>ACM standardisée</strong> (Bry et al, 2016) est une alternative (fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/stMCA.html"><code>stMCA()</code></a>). L’approche conditionnelle s’applique aussi au cas de variables actives numériques (fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/wcPCA.html"><code>wcPCA()</code></a>).</p>
<p>On construit maintenant l’espace des goûts communs aux femmes et aux hommes, ou, dit autrement, en neutralisant les différences sexuées. Dans le plan (1,2), les résultats obtenus sont très proches de ceux de l’ACM spécifique. La principale différence concerne le goût (très féminin) pour les films d’amour, qui ne se distingue plus sur l’axe 2.</p>
<p>La faible ampleur des différences entre les deux analyses est confirmée par le fait que l’analyse intra-classes rend compte de près de 99% de l’inertie totale du nuage.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">within</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wcMCA.html">wcMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, class <span class="op">=</span> <span class="va">Taste</span><span class="op">$</span><span class="va">Gender</span>, excl <span class="op">=</span> <span class="va">junk</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">within</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Within-class analysis"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/within-1.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">within</span><span class="op">$</span><span class="va">ratio</span></span></code></pre></div>
<pre><code>[1] 0.9896936</code></pre>
</div>
<div class="section level4">
<h4 id="analyses-multi-tableaux-symétriques">Analyses multi-tableaux (symétriques)<a class="anchor" aria-label="anchor" href="#analyses-multi-tableaux-sym%C3%A9triques"></a>
</h4>
<p>Un autre cas de figure se présente quand les variables actives sont réparties en plusieurs groupes homogènes et que ces groupes jouent un rôle symétrique (contrairement aux approches avec variables instrumentales).</p>
<p>Avec deux groupes de variables, on peut réaliser une <strong>analyse de co-inertie</strong> (Tucker, 1958 ; Dolédec et Chessel, 1994) afin d’étudier les structures communes aux deux groupes (fonctions <a href="https://nicolas-robette.github.io/GDAtools/reference/coiMCA.html"><code>coiMCA()</code></a> si les groupes sont composés de variables catégorielles, <a href="https://nicolas-robette.github.io/GDAtools/reference/coiPCA.html"><code>coiPCA()</code></a> s’ils sont composés de variables numériques).</p>
<p>On applique une analyse de co-inertie à un nouveau jeu de données, dans lequel un groupe de 5 variables décrit les goûts pour différents genres musicaux, et un second groupe de 2 variables décrit la fréquence d’écoute (en général ou “focalisée”, c’est-à-dire en ne faisant rien d’autre).</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Music</span><span class="op">)</span></span>
<span><span class="va">Xa</span> <span class="op">&lt;-</span> <span class="va">Music</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>  <span class="co"># music tastes</span></span>
<span><span class="va">Xb</span> <span class="op">&lt;-</span> <span class="va">Music</span><span class="op">[</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>  <span class="co"># frequency of listening</span></span>
<span><span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coiMCA.html">coiMCA</a></span><span class="op">(</span><span class="va">Xa</span>, <span class="va">Xb</span>, </span>
<span>               excl.a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FrenchPop.NA"</span>,<span class="st">"Rap.NA"</span>,<span class="st">"Rock.NA"</span>,<span class="st">"Jazz.NA"</span>,<span class="st">"Classical.NA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">factoextra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_ca.html" class="external-link">fviz_ca</a></span><span class="op">(</span><span class="va">coin</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="st">"Co-inertia analysis"</span>,</span>
<span>                    col.col <span class="op">=</span> <span class="st">"dodgerblue3"</span>, col.row <span class="op">=</span> <span class="st">"tomato2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/coinertia-1.png" width="700"></p>
<p>L’examen du premier axe montre que le rap, le jazz et le rock sont du côté de l’écoute quotidienne et d’une écoute focalisée fréquente ou quotidienne, alors que le goût pour la musique populaire française est du côté d’une écoute non-quotidienne et de l’absence d’écoute focalisée.</p>
<p>L’<strong>Analyse Factorielle Multiple</strong> (AFM, voir Escofier et Pagès, 1994) permet de traiter deux groupes de variables <em>ou plus</em>. Elle prend en compte à la fois les structures propres à chacun des groupes et les structures communes aux groupes. La fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/multiMCA.html"><code>multiMCA()</code></a> permet de réaliser des AFM en utilisant des ACM spécifiques ou des Class Specific Analysis.</p>
<p>Ici, on reprend les données <code>Taste</code>. Un groupe de variables décrit l’écoute de genres musicaux et l’autre le goût pour des genres de films, et l’AFM utilise des ACM spécifiques.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mca1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/speMCA.html">speMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, excl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mca2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/speMCA.html">speMCA</a></span><span class="op">(</span><span class="va">Taste</span><span class="op">[</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, excl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">18</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mfa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multiMCA.html">multiMCA</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mca1</span>,<span class="va">mca2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mfa</span>, shapes<span class="op">=</span><span class="cn">FALSE</span>, legend<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Analyse factorielle multiple"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/mfa-1.png" width="700"></p>
<p>On observe que ce sont surtout les variables cinématographiques qui structurent le plan (1,2). Une AFM ne présente guère d’intérêt ici, car les deux espaces sont très peu liés : le coefficient RV est de 1,4% (le <strong>coefficient RV</strong> - fonction <a href="https://nicolas-robette.github.io/GDAtools/reference/rvcoef.html"><code>rvcoef()</code></a> - est une sorte de coefficient de corrélation entre les groupes de variables).</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rvcoef.html">rvcoef</a></span><span class="op">(</span><span class="va">mca1</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span>, <span class="va">mca2</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.01412768</code></pre>
<p>NB : Il existe une autre approche pour traiter les cas de plusieurs groupes de variables, que ces groupes jouent un rôle symétrique ou non, c’est l’<strong>approche PLS</strong> (Partial Least Square, voir Tenenhaus, 1998). La plupart de ces techniques sont disponibles dans le package <a href="https://cran.r-project.org/package=plsdepot" class="external-link"><code>plsdepot</code></a>, développé par <a href="https://github.com/gastonstat" class="external-link">Gaston Sanchez</a>.</p>
</div>
<div class="section level4">
<h4 id="analyse-des-correspondances-non-symétriques">Analyse des correspondances non-symétriques<a class="anchor" aria-label="anchor" href="#analyse-des-correspondances-non-sym%C3%A9triques"></a>
</h4>
<p>Lorsqu’un tableau de contingence présente une structure de dépendance, c’est-à-dire lorsque le rôle des deux variables n’est pas symétrique mais que, au contraire, l’une peut être considérée comme prédisant l’autre, l’analyse des correspondances non symétrique peut être utilisée pour représenter la structure prédictive du tableau et évaluer le pouvoir prédictif de la variable prédictive.</p>
<p>Techniquement, l’analyse des correspondances non symétrique est très similaire à l’analyse des correspondances standard, la principale différence étant que les colonnes du tableau de contingence ne sont pas pondérées par leur rareté (c’est-à-dire par l’inverse des fréquences marginales).</p>
<p>On étudie ici des données sur la répartition de diverses tâches domestiques dans les couples. On considère que le type de tâche domestique est prédicteur de <em>qui</em> réalise cette tâche.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">ade4</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">housetasks</span><span class="op">)</span></span>
<span><span class="va">housetasks</span></span></code></pre></div>
<pre><code>           Wife Alternating Husband Jointly
Laundry     156          14       2       4
Main_meal   124          20       5       4
Dinner       77          11       7      13
Breakfeast   82          36      15       7
Tidying      53          11       1      57
Dishes       32          24       4      53
Shopping     33          23       9      55
Official     12          46      23      15
Driving      10          51      75       3
Finances     13          13      21      66
Insurance     8           1      53      77
Repairs       0           3     160       2
Holidays      0           1       6     153</code></pre>
<p>Les biplots d’une analyse des correspondances non symétrique reflètent la structure de dépendance du tableau de contingence et ne doivent donc pas être interprétés comme les plans d’une analyse des correspondances standard. Un premier principe est que le graphique affiche les profils-lignes centrés. Un deuxième principe est que les relations entre les lignes et les colonnes sont contenues dans leurs produits scalaires : les lignes sont représentées sous forme de vecteurs, également appelés <em>facteurs</em> du biplot, et les colonnes sont projetées sur ces vecteurs. Si certaines colonnes ont des projections sur le vecteur-ligne très éloignées de l’origine, la ligne présente une augmentation relativement importante de la prévisibilité et son profil s’écarte considérablement du profil marginal, en particulier pour cette colonne.</p>
<p>Pour des conseils plus détaillés sur l’interprétation, voir Kroonenberg et Lombardo (1999, pp.377-378).</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nsCA.html">nsCA</a></span><span class="op">(</span><span class="va">housetasks</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nsca.biplot.html">nsca.biplot</a></span><span class="op">(</span><span class="va">nsca</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/nsca2-1.png" width="700"></p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsca</span><span class="op">$</span><span class="va">GK.tau</span></span></code></pre></div>
<pre><code>[1] 0.4067139</code></pre>
<p>On constate le fait de savoir que les tâches domestiques concernent la lessive ou la préparation des repas “augmente les performances de prédiction” de tâches féminines. Les réparations sont associées aux tâches masculines et l’organisation des vacances aux tâches conjointes.</p>
<p>Le <strong>tau de Goodman et Kruskal</strong> est une mesure d’association globale <em>asymétrique</em>. Sa valeur élevée (0,41) indique ici que le type de tâche domestique prédit bien qui réalise la tâche.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="quelques-points-pratiques">Quelques points pratiques<a class="anchor" aria-label="anchor" href="#quelques-points-pratiques"></a>
</h2>
<div class="section level4">
<h4 id="liens-avec-dautres-packages">Liens avec d’autres packages<a class="anchor" aria-label="anchor" href="#liens-avec-dautres-packages"></a>
</h4>
<p>Les variantes de l’ACM et de l’ACP proposées dans GDAtools sont, autant que possible, prévues pour créer des objets similaires à ceux créés par les fonctions <code><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html" class="external-link">PCA()</a></code>, <code><a href="https://rdrr.io/pkg/FactoMineR/man/MCA.html" class="external-link">MCA()</a></code> et <code><a href="https://rdrr.io/pkg/FactoMineR/man/CA.html" class="external-link">CA()</a></code> du package <a href="https://cran.r-project.org/package=FactoMineR" class="external-link"><code>FactoMineR</code></a>. Cela permet à ces objets d’être (le plus souvent) compatibles avec un certain nombre de fonctionnalités d’interprétation et de visualisation des résultats :</p>
<ul>
<li><p>les fonctions graphiques du package <a href="https://cran.r-project.org/package=FactoMineR" class="external-link"><code>FactoMineR</code></a>,</p></li>
<li><p>le package <a href="https://cran.r-project.org/package=Factoshiny" class="external-link"><code>Factoshiny</code></a> pour la construction interactive de graphiques,</p></li>
<li><p>le formidable package <a href="https://juba.github.io/explor/" class="external-link"><code>explor</code></a>, développé par <a href="https://github.com/juba" class="external-link">Julien Barnier</a>, pour l’exploration interactive des résultats,</p></li>
<li><p>le package <a href="https://rpkgs.datanovia.com/factoextra/index.html" class="external-link"><code>factoextra</code></a> pour extraire et visualiser les résultats.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="gestion-des-couleurs">Gestion des couleurs<a class="anchor" aria-label="anchor" href="#gestion-des-couleurs"></a>
</h4>
<p>La plupart des fonctions de représentations graphiques de <code>GDAtools</code> ont été conçues avec la “grammaire” (et les palettes de couleurs par défaut) de <a href="https://ggplot2.tidyverse.org/" class="external-link"><code>ggplot2</code></a> et de manière à pouvoir personnaliser les couleurs de manière très flexible. On peut en effet utiliser les fonctions de type <code>scale_color_*</code>, comme <code><a href="https://ggplot2.tidyverse.org/reference/scale_grey.html" class="external-link">scale_color_grey()</a></code> pour les niveaux de gris, <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer()</a></code> pour les palettes <a href="http://colorbrewer2.org/" class="external-link"><code>ColorBrewer</code></a>, <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual()</a></code> pour utiliser des palettes personnalisées, ou encore <code>paletteer::scale_color_paletteer_d()</code> du package <a href="https://emilhvitfeldt.github.io/paletteer/" class="external-link"><code>paletteer</code></a> pour accéder à un grand nombre de palettes de couleurs existant dans R (dont une liste est accessible <a href="https://pmassicotte.github.io/paletteer_gallery/" class="external-link">ici</a>). Il faut toutefois veiller à choisir une palette disposant d’au moins autant de couleurs qu’il y a de variables à représenter (faute de quoi certaines variables resteront invisibles).</p>
<p>Par exemple, pour afficher le nuage des variables avec la palette <code>ColorBrewer</code> “Paired1”, on procédera ainsi.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcloud_variables.html">ggcloud_variables</a></span><span class="op">(</span><span class="va">mca</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Paired"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_AGD_files/figure-html/colors-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://github.com/nicolas-robette" class="external-link">Nicolas Robette</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
